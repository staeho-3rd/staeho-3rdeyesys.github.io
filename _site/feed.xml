<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.7.2">Jekyll</generator><link href="https://docs.3rdeyesys.com/feed.xml" rel="self" type="application/atom+xml" /><link href="https://docs.3rdeyesys.com/" rel="alternate" type="text/html" /><updated>2022-01-03T16:50:34+09:00</updated><id>https://docs.3rdeyesys.com/feed.xml</id><title type="html">3rdeyesys</title><subtitle>써드아이시스템 기술문서</subtitle><author><name>{&quot;name&quot;=&gt;nil, &quot;email&quot;=&gt;nil, &quot;twitter&quot;=&gt;nil}</name></author><entry><title type="html">Windows 서버 모니터링 성능 정보 수집 오류 해결 방법</title><link href="https://docs.3rdeyesys.com/81.manage/ncloud_management_monitoring_win_perf_data_error_troubleshoot/" rel="alternate" type="text/html" title="Windows 서버 모니터링 성능 정보 수집 오류 해결 방법" /><published>2021-12-28T00:00:00+09:00</published><updated>2021-12-28T00:00:00+09:00</updated><id>https://docs.3rdeyesys.com/81.manage/ncloud_management_monitoring_win_perf_data_error_troubleshoot</id><content type="html" xml:base="https://docs.3rdeyesys.com/81.manage/ncloud_management_monitoring_win_perf_data_error_troubleshoot/">&lt;h2 id=&quot;개요&quot;&gt;개요&lt;/h2&gt;
&lt;p&gt;Ncloud(네이버 클라우드) Monitoring 서비스를 이용해 서버 시스템 자원들(CPU, Memory 등)의 성능 정보를 수집, 모니터링할 때 간혹 성능 정보가 수집되지 않는 경우가 발생하기도 합니다. 
특히 Windows 서버의 경우 Windows 자체 성능 테이블을 참조하여 데이터를 수집하기 때문에 Windows 자체 성능 테이블에 문제가 발생할 경우 성능 정보를 수집하지 못하게 됩니다.&lt;br /&gt;
여기서는 Ncloud(네이버 클라우드) Classic 환경에서 Windows 서버의 모니터링 성능 정보가 수집되지 않을 때 해결 방법을 정리해보겠습니다.&lt;/p&gt;

&lt;h2 id=&quot;서버-환경&quot;&gt;서버 환경&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;Classic 환경&lt;/li&gt;
  &lt;li&gt;Windows Server 2016 64bit R2 en&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;오류-상황&quot;&gt;오류 상황&lt;/h2&gt;
&lt;p&gt;성능 정보가 수집되지 않을 경우 아래와 같이 Monitoring 정보에서 그래프가 특정 시점 이후로 끊겨서 표시되게 됩니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_management_monitoring_win_perf_data_error_troubleshoot_01.png&quot; alt=&quot;Ncloud(네이버 클라우드) Classic 환경에서 Windows 서버의 모니터링 성능 정보를 수집할 때 발생하는 오류를 해결하는 방법입니다&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;서버-상태-확인&quot;&gt;서버 상태 확인&lt;/h2&gt;

&lt;h4 id=&quot;서버-성능-정보-상태-확인&quot;&gt;서버 성능 정보 상태 확인&lt;/h4&gt;
&lt;p&gt;우선 서버에 접속해서 서버의 작업 관리자 (Task Manager)를 실행, 성능(Performance)탭을 열고 CPU, Memory, Disk, Ethernet 등의 성능 정보가 제대로 표시되는지 확인합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_management_monitoring_win_perf_data_error_troubleshoot_04.png&quot; alt=&quot;Ncloud(네이버 클라우드) Classic 환경에서 Windows 서버의 모니터링 성능 정보를 수집할 때 발생하는 오류를 해결하는 방법입니다&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;모니터링-agent-상태-확인&quot;&gt;모니터링 Agent 상태 확인&lt;/h4&gt;
&lt;p&gt;Ncloud(네이버 클라우드) 서버들에는 모니터링 정보를 수집하기 위한 Agent가 설치되는데 이 모니터링 Agent가 작동하고 있는지 확인합니다.&lt;/p&gt;

&lt;p&gt;아래와 같이 Windows PowerShell에서 서비스를 검색합니다. 
Agent가 표시되는지 Status가 Running 상태인지 확인합니다.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Get-Service &lt;span class=&quot;nt&quot;&gt;-name&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;nsight&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_management_monitoring_win_perf_data_error_troubleshoot_03.png&quot; alt=&quot;Ncloud(네이버 클라우드) Classic 환경에서 Windows 서버의 모니터링 성능 정보를 수집할 때 발생하는 오류를 해결하는 방법입니다&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;문제-해결&quot;&gt;문제 해결&lt;/h2&gt;

&lt;h4 id=&quot;서버-성능-정보에-문제가-있는-경우&quot;&gt;서버 성능 정보에 문제가 있는 경우&lt;/h4&gt;
&lt;p&gt;혹시 서버 성능 정보가 제대로 표시 되지 않을 경우에는 cmd 창에서 아래 명령어로 성능 정보 테이블을 복구합니다.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; lodctr /R
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;../../images/ncloud_management_monitoring_win_perf_data_error_troubleshoot_05.png&quot; alt=&quot;Ncloud(네이버 클라우드) Classic 환경에서 Windows 서버의 모니터링 성능 정보를 수집할 때 발생하는 오류를 해결하는 방법입니다&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;서버-성능-정보가-정상인-경우&quot;&gt;서버 성능 정보가 정상인 경우&lt;/h4&gt;
&lt;p&gt;서버의 성능 정보가 제대로 표시되는데도 Monitoring 데이터가 제대로 수집되지 않는다면 cmd 창에서 모니터링 Agent를 다시 실행합니다.&lt;/p&gt;

&lt;p&gt;우선 Agent를 중지 시킵니다.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; sc stop noms_nsight
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;../../images/ncloud_management_monitoring_win_perf_data_error_troubleshoot_07.png&quot; alt=&quot;Ncloud(네이버 클라우드) Classic 환경에서 Windows 서버의 모니터링 성능 정보를 수집할 때 발생하는 오류를 해결하는 방법입니다&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;그리고 Agent를 다시 실행 시킵니다.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; sc start noms_nsight
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_management_monitoring_win_perf_data_error_troubleshoot_06.png&quot; alt=&quot;Ncloud(네이버 클라우드) Classic 환경에서 Windows 서버의 모니터링 성능 정보를 수집할 때 발생하는 오류를 해결하는 방법입니다&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;monitoring-정보-수집-복구&quot;&gt;Monitoring 정보 수집 복구&lt;/h4&gt;
&lt;p&gt;문제가 해결되었다면 아래와 같이 Monitoring 정보가 제대로 수집되면서 그래프가 나타나기 시작합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_management_monitoring_win_perf_data_error_troubleshoot_02.png&quot; alt=&quot;Ncloud(네이버 클라우드) Classic 환경에서 Windows 서버의 모니터링 성능 정보를 수집할 때 발생하는 오류를 해결하는 방법입니다&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;복구-불가-상황&quot;&gt;복구 불가 상황&lt;/h2&gt;
&lt;p&gt;위 방법대로 했는데에도 복구가 되지 않을 경우에는 다음 2가지 데이터를 모아서 Ncloud(네이버 클라우드) 고객센터로 문의하셔야 합니다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;모니터링 Agent 상태 정보&lt;/li&gt;
  &lt;li&gt;모니터링 Agent 로그&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;모니터링-agent-상태-정보-확인&quot;&gt;모니터링 Agent 상태 정보 확인&lt;/h4&gt;
&lt;p&gt;모니터링 Agent가 설치된 경로에서 아래의 상태 정보 확인 명령어를 실행합니다.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;C:&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;rogram Files &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;x86&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\N&lt;/span&gt;BP&lt;span class=&quot;se&quot;&gt;\N&lt;/span&gt;Sight&amp;gt;noms_nsight.exe &lt;span class=&quot;nt&quot;&gt;-status&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;../../images/ncloud_management_monitoring_win_perf_data_error_troubleshoot_08.png&quot; alt=&quot;Ncloud(네이버 클라우드) Classic 환경에서 Windows 서버의 모니터링 성능 정보를 수집할 때 발생하는 오류를 해결하는 방법입니다&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;모니터링-agent-로그&quot;&gt;모니터링 Agent 로그&lt;/h4&gt;
&lt;p&gt;모니터링 Agent가 설치된 경로에 있는 파일과 폴더를 모두 압축합니다.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;C:&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;rogram Files &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;x86&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\N&lt;/span&gt;BP&lt;span class=&quot;se&quot;&gt;\N&lt;/span&gt;Sight&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;참고-url&quot;&gt;참고 URL&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;성능 수집 오류 해결 FAQ
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://www.ncloud.com/support/faq/all/1292&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://www.ncloud.com/support/faq/all/1292&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;blockquote&gt;
  &lt;p&gt;문서 최종 수정일 : 2021-12-28&lt;/p&gt;
&lt;/blockquote&gt;</content><author><name>{&quot;name&quot;=&gt;nil, &quot;email&quot;=&gt;nil, &quot;twitter&quot;=&gt;nil}</name></author><summary type="html">개요 Ncloud(네이버 클라우드) Monitoring 서비스를 이용해 서버 시스템 자원들(CPU, Memory 등)의 성능 정보를 수집, 모니터링할 때 간혹 성능 정보가 수집되지 않는 경우가 발생하기도 합니다. 특히 Windows 서버의 경우 Windows 자체 성능 테이블을 참조하여 데이터를 수집하기 때문에 Windows 자체 성능 테이블에 문제가 발생할 경우 성능 정보를 수집하지 못하게 됩니다. 여기서는 Ncloud(네이버 클라우드) Classic 환경에서 Windows 서버의 모니터링 성능 정보가 수집되지 않을 때 해결 방법을 정리해보겠습니다.</summary></entry><entry><title type="html">X-Forwarded-For를 이용해 Proxy, Load Balancer 환경에서 Client IP 기록하기</title><link href="https://docs.3rdeyesys.com/1.compute/ncloud_server_x_forwarded_for_client_ip_logging_guide/" rel="alternate" type="text/html" title="X-Forwarded-For를 이용해 Proxy, Load Balancer 환경에서 Client IP 기록하기" /><published>2021-12-17T00:00:00+09:00</published><updated>2021-12-17T00:00:00+09:00</updated><id>https://docs.3rdeyesys.com/1.compute/ncloud_server_x_forwarded_for_client_ip_logging_guide</id><content type="html" xml:base="https://docs.3rdeyesys.com/1.compute/ncloud_server_x_forwarded_for_client_ip_logging_guide/">&lt;h2 id=&quot;개요&quot;&gt;개요&lt;/h2&gt;
&lt;p&gt;X-Forwarded-For (XFF) 는 HTTP Header 중 하나로 Load Balancer(로드밸런서)나 Proxy Server를 통해 웹서버에 접속하는 Client의 IP 주소를 식별하는 표준 헤더입니다.&lt;br /&gt;
웹서버나 WAS 앞쪽에 Load Balancer 혹은 Proxy Server 등이 위치하게 된다면 서버 접근 로그에는 Client IP가 아닌 Load Balancer 혹은 Proxy Server의 IP 주소가 기록됩니다. 
이때 웹 어플리케이션에서 X-Forwarded-For 헤더를 이용하면 Client IP를 서버 접근 로그에 남길 수 있습니다.&lt;/p&gt;

&lt;p&gt;여기서는 Load Balancer와 연동된 CentOS 와 Ubuntu의 Apache 웹서버 환경에서 X-Forwarded-For 를 이용하여 Apache access_log에 Clinet의 IP를 저장하는 과정을 살펴보겠습니다.&lt;/p&gt;

&lt;h2 id=&quot;테스트-환경&quot;&gt;테스트 환경&lt;/h2&gt;
&lt;p&gt;테스트는 CentOS, Ubuntu OS가 각각 설치된 2대의 서버를 Load Balancer와 연동한 후 Cloud Log Analytics에서 Apache access_log를  수집해 IP 주소를 확인하는 방식으로 진행하겠습니다.&lt;/p&gt;

&lt;h4 id=&quot;network-환경&quot;&gt;Network 환경&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;VPC 대역 : 172.16.0.0/16&lt;/li&gt;
  &lt;li&gt;Subnet 대역 (Server) : 172.16.&lt;strong&gt;10&lt;/strong&gt;.0/24&lt;/li&gt;
  &lt;li&gt;Sbunet 대역 (Load Balancer) : 172.16.&lt;strong&gt;20&lt;/strong&gt;.0/24&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;server-환경&quot;&gt;Server 환경&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;xxf-test-1 : CentOS 7.8&lt;/li&gt;
  &lt;li&gt;xxf-test-2 : Ubuntu 18.04&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;테스트-서버&quot;&gt;테스트 서버&lt;/h4&gt;
&lt;p&gt;위 서버 환경에서 정리한 대로 CentOS, Ubuntu 2대의 서버를 준비했습니다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;VPC 환경에서 서버 생성하는 방법 : &lt;a href=&quot;/1.compute/ncp_server_vpc_create/&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://docs.3rdeyesys.com/1.compute/ncp_server_vpc_create/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_server_x_forwarded_for_client_ip_logging_guide_01.png&quot; alt=&quot;네이버 클라우드 서비스에서 X-Forwarded-For를 이용해 Proxy, Load Balancer 환경에서 Client IP를 Apache access_log에 기록하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;로드밸런서도 마찬가지로 준비하고, 서버와 연동까지 완료했습니다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;VPC 환경에서 Application Load Balancer 생성하는 방법 : &lt;a href=&quot;/2.networking/ncp_networking_load_balancer_application_lb/&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://docs.3rdeyesys.com/2.networking/ncp_networking_load_balancer_application_lb/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_server_x_forwarded_for_client_ip_logging_guide_02.png&quot; alt=&quot;네이버 클라우드 서비스에서 X-Forwarded-For를 이용해 Proxy, Load Balancer 환경에서 Client IP를 Apache access_log에 기록하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;설정-전-테스트&quot;&gt;설정 전 테스트&lt;/h2&gt;
&lt;p&gt;우선, &lt;strong&gt;X-Forwarded-For (XFF)&lt;/strong&gt; 설정을 하기 전에 어떻게 기록이 남는지 확인해보겠습니다.&lt;br /&gt;
아래와 같이 Load Balancer 주소로 접속해서 2대의 서버에 각각 접근하도록 합니다.&lt;br /&gt;
위에서 소개한 Application Load Balancer 생성하는 방법을 그대로 따라하면 아래와 같은 메시지를 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_server_x_forwarded_for_client_ip_logging_guide_11-1.png&quot; alt=&quot;네이버 클라우드 서비스에서 X-Forwarded-For를 이용해 Proxy, Load Balancer 환경에서 Client IP를 Apache access_log에 기록하는 방법&quot; style=&quot;width:560px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_server_x_forwarded_for_client_ip_logging_guide_11-2.png&quot; alt=&quot;네이버 클라우드 서비스에서 X-Forwarded-For를 이용해 Proxy, Load Balancer 환경에서 Client IP를 Apache access_log에 기록하는 방법&quot; style=&quot;width:560px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;apache-접속-로그-확인&quot;&gt;Apache 접속 로그 확인&lt;/h4&gt;
&lt;p&gt;Apache 접속 로그 파일은 아래의 위치에 존재하지만, 저희는 네이버 클라우드 (Ncloud)의 상품 중 하나인 &lt;strong&gt;Cloud Log Analytics&lt;/strong&gt;에서 로그를 수집해서 확인해보겠습니다.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;CentOS : /var/log/httpd/access_log&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Ubuntu : /var/log/apache2/access.log&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;Cloud Log Analytics 설정 가이드 : &lt;a href=&quot;/7.analytics/ncloud_analytics_cloud_log_analytics_guide/&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://docs.3rdeyesys.com/7.analytics/ncloud_analytics_cloud_log_analytics_guide/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Cloud Log Analytics에서 수집한 로그를 확인해보면 위에서 설정했던 &lt;strong&gt;Load Balancer의 IP 대역 (172.16.20.xx)&lt;/strong&gt;이 기록된 것을 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_server_x_forwarded_for_client_ip_logging_guide_03.png&quot; alt=&quot;네이버 클라우드 서비스에서 X-Forwarded-For를 이용해 Proxy, Load Balancer 환경에서 Client IP를 Apache access_log에 기록하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;centos-설정&quot;&gt;CentOS 설정&lt;/h2&gt;
&lt;p&gt;이제 실제 Client IP가 기록 되도록 설정을 변경해보겠습니다.&lt;br /&gt;
우선 CentOS에서는 &lt;strong&gt;httpd.conf&lt;/strong&gt; 파일만 수정하면 됩니다.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;~# vi /etc/httpd/conf/httpd.conf

&lt;span class=&quot;c&quot;&gt;# vi Line Number 표시하기&lt;/span&gt;
:set number
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;httpd.conf 파일 196번째 라인의 LogFormat 항목에서 &lt;strong&gt;%h&lt;/strong&gt; 를 &lt;strong&gt;%{X-Forwarded-For}i&lt;/strong&gt; 로 수정합니다.&lt;/p&gt;

&lt;h4 id=&quot;httpdconf-수정-전&quot;&gt;httpd.conf 수정 전&lt;/h4&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;196   LogFormat &lt;span class=&quot;s2&quot;&gt;&quot;%h %l %u %t &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;%r&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; %&amp;gt;s %b &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;%{Referer}i&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;%{User-Agent}i&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; combined
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;../../images/ncloud_server_x_forwarded_for_client_ip_logging_guide_04.png&quot; alt=&quot;네이버 클라우드 서비스에서 X-Forwarded-For를 이용해 Proxy, Load Balancer 환경에서 Client IP를 Apache access_log에 기록하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;httpdconf-수정-후&quot;&gt;httpd.conf 수정 후&lt;/h4&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;196   LogFormat &lt;span class=&quot;s2&quot;&gt;&quot;%{X-Forwarded-For}i %l %u %t &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;%r&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; %&amp;gt;s %b &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;%{Referer}i&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;%{User-Agent}i&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; combined
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;../../images/ncloud_server_x_forwarded_for_client_ip_logging_guide_05.png&quot; alt=&quot;네이버 클라우드 서비스에서 X-Forwarded-For를 이용해 Proxy, Load Balancer 환경에서 Client IP를 Apache access_log에 기록하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;apache-재시작&quot;&gt;Apache 재시작&lt;/h4&gt;
&lt;p&gt;httpd.conf 파일 수정 후에 Apache를 재시작합니다. 로그 테스트는 Ubuntu까지 설정을 마친 후에 진행하겠습니다.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;~# systemctl restart httpd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;ubuntu-설정&quot;&gt;Ubuntu 설정&lt;/h2&gt;
&lt;p&gt;Ubuntu에서는 apache2.conf 파일을 수정하기 전에 &lt;strong&gt;remoteip 모듈&lt;/strong&gt;을 사용하도록 설정해줘야 합니다.&lt;/p&gt;

&lt;h4 id=&quot;remoteip-설정&quot;&gt;remoteip 설정&lt;/h4&gt;
&lt;p&gt;아래 명령어를 실행하면 remoteip 모듈이 활성화 됩니다.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;~# a2enmod remoteip
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;../../images/ncloud_server_x_forwarded_for_client_ip_logging_guide_06.png&quot; alt=&quot;네이버 클라우드 서비스에서 X-Forwarded-For를 이용해 Proxy, Load Balancer 환경에서 Client IP를 Apache access_log에 기록하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;remoteipload-수정&quot;&gt;remoteip.load 수정&lt;/h4&gt;
&lt;p&gt;다음으로 remoteip.load 파일을 수정해서 아래쪽에 [&lt;strong&gt;RemoteIPHeader X-FORWARDED-FOR&lt;/strong&gt;]을 추가 합니다.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;~# vi /etc/apache2/mods-enabled/remoteip.load
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;remoteipload-수정-전&quot;&gt;remoteip.load 수정 전&lt;/h4&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;LoadModule remoteip_module /usr/lib/apache2/modules/mod_remoteip.so
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h4 id=&quot;remoteipload-수정-후&quot;&gt;remoteip.load 수정 후&lt;/h4&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;LoadModule remoteip_module /usr/lib/apache2/modules/mod_remoteip.so
RemoteIPHeader X-FORWARDED-FOR
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;../../images/ncloud_server_x_forwarded_for_client_ip_logging_guide_07.png&quot; alt=&quot;네이버 클라우드 서비스에서 X-Forwarded-For를 이용해 Proxy, Load Balancer 환경에서 Client IP를 Apache access_log에 기록하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;apache2conf-수정&quot;&gt;apache2.conf 수정&lt;/h4&gt;
&lt;p&gt;다음으로 &lt;strong&gt;apache2.conf&lt;/strong&gt; 파일을 수정합니다.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;~# vi /etc/apache2/apache2.conf

&lt;span class=&quot;c&quot;&gt;# vi Line Number 표시하기&lt;/span&gt;
:set number
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;apache2.conf 213번째 라인의 LogFormat 부분에서 &lt;strong&gt;%h&lt;/strong&gt; 를 &lt;strong&gt;%a&lt;/strong&gt; 로 변경합니다.&lt;/p&gt;

&lt;h4 id=&quot;apache2conf-수정-전&quot;&gt;apache2.conf 수정 전&lt;/h4&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;213 LogFormat &lt;span class=&quot;s2&quot;&gt;&quot;%h %l %u %t &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;%r&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; %&amp;gt;s %O &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;%{Referer}i&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;%{User-Agent}i&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; combined  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;../../images/ncloud_server_x_forwarded_for_client_ip_logging_guide_08.png&quot; alt=&quot;네이버 클라우드 서비스에서 X-Forwarded-For를 이용해 Proxy, Load Balancer 환경에서 Client IP를 Apache access_log에 기록하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;apache2conf-수정-후&quot;&gt;apache2.conf 수정 후&lt;/h4&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;213 LogFormat &lt;span class=&quot;s2&quot;&gt;&quot;%a %l %u %t &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;%r&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; %&amp;gt;s %O &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;%{Referer}i&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;%{User-Agent}i&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; combined  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;../../images/ncloud_server_x_forwarded_for_client_ip_logging_guide_09.png&quot; alt=&quot;네이버 클라우드 서비스에서 X-Forwarded-For를 이용해 Proxy, Load Balancer 환경에서 Client IP를 Apache access_log에 기록하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;apache-재시작-1&quot;&gt;Apache 재시작&lt;/h4&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;~# systemctl restart apache2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;설정-후-테스트&quot;&gt;설정 후 테스트&lt;/h2&gt;
&lt;p&gt;위와 같이  CentOS, Ubuntu 2대 서버에서 설정을 모두 마친 후에 로드 밸런서 URL로 접속합니다.&lt;br /&gt;
이후에 Cloud Log Analytics에서 로그를 확인해보면 아래와 같이 로드밸런서 IP가 아닌 실제 접속한 Client의 IP가 기록된 것을 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_server_x_forwarded_for_client_ip_logging_guide_10.png&quot; alt=&quot;네이버 클라우드 서비스에서 X-Forwarded-For를 이용해 Proxy, Load Balancer 환경에서 Client IP를 Apache access_log에 기록하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;참고-url&quot;&gt;참고 URL&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;X-Forwarded-For 안내
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://developer.mozilla.org/ko/docs/Web/HTTP/Headers/X-Forwarded-For&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://developer.mozilla.org/ko/docs/Web/HTTP/Headers/X-Forwarded-For&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;blockquote&gt;
  &lt;p&gt;문서 최종 수정일 : 2021-12-17&lt;/p&gt;
&lt;/blockquote&gt;</content><author><name>{&quot;name&quot;=&gt;nil, &quot;email&quot;=&gt;nil, &quot;twitter&quot;=&gt;nil}</name></author><summary type="html">개요 X-Forwarded-For (XFF) 는 HTTP Header 중 하나로 Load Balancer(로드밸런서)나 Proxy Server를 통해 웹서버에 접속하는 Client의 IP 주소를 식별하는 표준 헤더입니다. 웹서버나 WAS 앞쪽에 Load Balancer 혹은 Proxy Server 등이 위치하게 된다면 서버 접근 로그에는 Client IP가 아닌 Load Balancer 혹은 Proxy Server의 IP 주소가 기록됩니다. 이때 웹 어플리케이션에서 X-Forwarded-For 헤더를 이용하면 Client IP를 서버 접근 로그에 남길 수 있습니다.</summary></entry><entry><title type="html">Cloud Log Analytics 설정 가이드</title><link href="https://docs.3rdeyesys.com/7.analytics/ncloud_analytics_cloud_log_analytics_guide/" rel="alternate" type="text/html" title="Cloud Log Analytics 설정 가이드" /><published>2021-12-10T00:00:00+09:00</published><updated>2021-12-10T00:00:00+09:00</updated><id>https://docs.3rdeyesys.com/7.analytics/ncloud_analytics_cloud_log_analytics_guide</id><content type="html" xml:base="https://docs.3rdeyesys.com/7.analytics/ncloud_analytics_cloud_log_analytics_guide/">&lt;h2 id=&quot;개요&quot;&gt;개요&lt;/h2&gt;
&lt;p&gt;Cloud Log Analytics는 Ncloud(네이버 클라우드)가 제공하는 여러 서비스에서 발생하는 다양한 로그들을 한 곳에 모아 저장하고 손쉽게 분석할 수 있는 서비스로, 
검색 기능을 이용해 여러 종류의 로그를 한 곳에서 한번에 조회하고 분석할 수 있어 효과적인 로그 관리가 가능합니다.&lt;/p&gt;

&lt;h2 id=&quot;로그-템플릿-종류&quot;&gt;로그 템플릿 종류&lt;/h2&gt;
&lt;p&gt;Cloud Log Analytics는 텍스트 형식으로 생성되는 모든 종류의 로그 데이터 파일을 수집할 수 있는데, 사전에 제공되는 로그 템플릿 종류는 다음과 같습니다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Server syslog&lt;/li&gt;
  &lt;li&gt;Apache 로그(Access log, Apache Error Log)&lt;/li&gt;
  &lt;li&gt;MySQL 설치형 상품의 로그(Error Log, Slow Log)&lt;/li&gt;
  &lt;li&gt;Microsoft SQL Server 설치형 상품의 Error Log&lt;/li&gt;
  &lt;li&gt;Tomcat 로그(Catalina Log)&lt;/li&gt;
  &lt;li&gt;Windows 서버의 Event Log&lt;/li&gt;
  &lt;li&gt;Windows 서버의 각종 text 형식의 로그&lt;/li&gt;
  &lt;li&gt;Cloud DB for MySQL 로그&lt;/li&gt;
  &lt;li&gt;Cloud DB for MSSQL 로그&lt;/li&gt;
  &lt;li&gt;Cloud DB for MongoDB 로그&lt;/li&gt;
  &lt;li&gt;Application Server Launcher 로그&lt;/li&gt;
  &lt;li&gt;Application Load Balancer 로그&lt;/li&gt;
  &lt;li&gt;Search Engine Service 로그&lt;/li&gt;
  &lt;li&gt;Cloud Data Streaming Service 로그&lt;/li&gt;
  &lt;li&gt;Bare Metal Server 로그&lt;/li&gt;
  &lt;li&gt;그외 템플릿으로 제공되지 않는 로그도 Custom Log 기능으로 직접 대상 로그를 지정해서 수집할 수 있습니다&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;저장-용량&quot;&gt;저장 용량&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;최대 100GB&lt;/strong&gt;까지 저장할 수 있습니다.&lt;/li&gt;
  &lt;li&gt;100GB 용량을 초과했을 경우 추가 저장 용량 확보를 위해 과거부터 전날까지의 데이터가 삭제될 수 있습니다.&lt;/li&gt;
  &lt;li&gt;CLA로 수집되는 로그량이 하루 10GB 이상을 넘거나 천만 건 이상일 경우 저장된 로그 검색시 성능에 제한이 발생할 수 있습니다.&lt;/li&gt;
  &lt;li&gt;저장 용량과 저장 기간을 더 늘리길 원할 경우 고객지원으로 문의해야 합니다.&lt;/li&gt;
  &lt;li&gt;과거 데이터를 보관하려면 [자동 보내기] 기능을 이용하여 과거 데이터를 Object Storage로 백업할 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;로그-보관-기간&quot;&gt;로그 보관 기간&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;Cloud Log Analytics 서비스는 &lt;strong&gt;최대 30일&lt;/strong&gt; 동안 데이터가 보관되며, 검색 및 대시보드에서 확인할 수 있습니다.&lt;/li&gt;
  &lt;li&gt;30일이 지난 데이터는 과거 데이터부터 순차적으로 삭제됩니다.&lt;/li&gt;
  &lt;li&gt;30일이 지나지 않았더라도 저장된 데이터가 100GB를 초과하면 과거부터 전날까지의 데이터가 매일 삭제될 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;이용신청&quot;&gt;이용신청&lt;/h2&gt;
&lt;p&gt;Ncloud(네이버 클라우드) 콘솔 [Cloud Log Analytics] - [Subscription]에서 [이용 신청] 버튼을 클릭합니다. 
Cloud Log Analytics는 Classic, VPC 환경 공통 서비스이므로 어느쪽 환경에서 이용신청을 해도 상관없습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_01.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;설정---linux&quot;&gt;설정 - Linux&lt;/h2&gt;
&lt;p&gt;먼저 Linux 서버에서 설정하는 방법을 알아보겠습니다.&lt;br /&gt;
[Cloud Log Analytics] - [Management]에서 로그를 수집할 서버를 선택하고, [수집 설정] 버튼을 클릭합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_02.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Log 수집 설정 화면에서 수집할 로그 템플릿을 선택하거나, 직접 [Custom Log]를 선택해서 로그 형태를 설정한 후에 [적용] 버튼을 클릭합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_03.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;로그-수집-agent-설치&quot;&gt;로그 수집 Agent 설치&lt;/h4&gt;
&lt;p&gt;Log 수집 설정을 마치면 [로그 수집 Agent] 설치 안내가 나옵니다.&lt;br /&gt;
로그 수집 Agent 설치 명령어에는 URL 뒤쪽에 설치 하려는 서버에 해당하는 &lt;strong&gt;설치키(Install Key)&lt;/strong&gt;가 포함되어 있습니다. 그러므로 URL을 수정해서도 안되고 다른 서버에 사용할 수도 없습니다.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# VPC 환경&lt;/span&gt;
~# curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; http://cm.vcla.ncloud.com/setUpClaVPC/&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;설치키&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Install Key&lt;span class=&quot;o&quot;&gt;)}&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;sh

&lt;span class=&quot;c&quot;&gt;# Classic 환경&lt;/span&gt;
~# curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; http://cm.cla.ncloud.com/setUpCla/&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;설치키&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Install Key&lt;span class=&quot;o&quot;&gt;)}&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_04.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;서버에 실제로 설치해보면 아래와 같이 설치 과정이 진행되고,&lt;br /&gt;
설치가 완료되면 마지막에 &lt;strong&gt;Finish Installation&lt;/strong&gt;이라는 메시지가 출력됩니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_06.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;설치된 Agent가 제대로 작동하고 있는지 확인해보면 아래와 같이 active (running) 상태인 것을 확인할 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;~# systemctl status filebeat
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_07.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;설정---windows&quot;&gt;설정 - Windows&lt;/h2&gt;
&lt;p&gt;다음으로 Windows 서버에서 설정하는 방법을 살펴보겠습니다.&lt;br /&gt;
마찬가지로 서버를 선택하고 [수집 설정] 버튼을 클릭합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_11.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;로그 수집 설정에서 Log Template은 [EventLog]를 선택합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_12.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;설정을 마치면 Agent 설치 가이드를 확인할 수 있습니다.&lt;br /&gt;
서버에서 [Windows PowerShell]을 열고, 아래 명령어를 실행합니다. 마찬가지로 마지막에는 설치 서버에 해당하는 &lt;strong&gt;설치키&lt;/strong&gt;가 포함되어 있습니다.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# VPC 환경&lt;/span&gt;
Invoke-Expression &lt;span class=&quot;k&quot;&gt;$((&lt;/span&gt;New-Object System.Net.WebClient&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.DownloadString&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://cm.vcla.ncloud.com/setUpwinClaVPC/{설치키(Install Key)}&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Classic 환경&lt;/span&gt;
Invoke-Expression &lt;span class=&quot;k&quot;&gt;$((&lt;/span&gt;New-Object System.Net.WebClient&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.DownloadString&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://cm.cla.ncloud.com/setUpwinClaVPC/{설치키(Install Key)}&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_13.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;설치가 완료되면 마지막에 &lt;strong&gt;Finish Installation&lt;/strong&gt;이라는 메시지가 출력됩니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_14.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;windows-server-2019-지원-여부&quot;&gt;Windows Server 2019 지원 여부&lt;/h4&gt;
&lt;p&gt;현재 Windows Server 2019는 지원하지 않고, 2022년 상반기 지원 예정입니다.&lt;br /&gt;
Windows Server 2019는 아래와 같이 선택을 해도 [수집 설정] 버튼을 활성화되지 않습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_15.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;로그-확인&quot;&gt;로그 확인&lt;/h2&gt;
&lt;p&gt;Agent 설치 후 [Dashboard]를 확인해보면 로그가 수집되고 있을 것을 알 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_08.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;[Search] 메뉴에서는 로그 내용을 자세히 검색, 확인할 수 있고, 굳이 서버에 접속하지 않더라도 필요한 로그를 콘솔 화면에서 직접 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_09.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;로그-백업&quot;&gt;로그 백업&lt;/h2&gt;
&lt;p&gt;Cloud Log Analytics는 수집된 로그를 Object Storage로 내보내기하거나 Excel 파일로 다운로드 해서 백업할 수 있는 기능을 지원합니다.&lt;/p&gt;

&lt;h4 id=&quot;수동-백업&quot;&gt;수동 백업&lt;/h4&gt;
&lt;p&gt;[Search] 메뉴에 [Object Storage로 내보내기]와 [X 다운로드] 버튼이 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_24.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;[Object Storage로 내보내기] 버튼을 클릭하면 내보내기 할 버킷을 선택할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_25.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:600px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;자동-백업&quot;&gt;자동 백업&lt;/h4&gt;
&lt;p&gt;[Export Log] 메뉴에서 [자동 내보내기 설정]을 클릭합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_16.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;설정 화면에서 내보내기를 할 Object Storage의 버킷을 선택합니다. 혹시 버킷이 생성되지 않았다면 Object Storage로 가서 먼저 버킷을 생성하고 와야 합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_17.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:600px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;내보내기는 하루에 한번 진행되므로 설정 후 다음 날 Object Storage에서 아래와 같이 파일이 저장되어 있는 것을 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_20.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;로그-수집-해제&quot;&gt;로그 수집 해제&lt;/h2&gt;
&lt;p&gt;더 이상 로그를 수집할 필요가 없어지면, 로그 수집 설정을 해제하면 됩니다.&lt;/p&gt;

&lt;h4 id=&quot;linux-서버-로그-수집-해제&quot;&gt;Linux 서버 로그 수집 해제&lt;/h4&gt;
&lt;p&gt;서버를 선택하고 [수집 해제] 버튼을 클릭합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_22.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;로그 수집 해제를 위한 가이드에서 로그 수집 Agent 삭제 명령어를 복사합니다.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# VPC 환경&lt;/span&gt;
~# curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; http://cm.vcla.ncloud.com/removeCla | &lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;sh

&lt;span class=&quot;c&quot;&gt;# Classic 환경&lt;/span&gt;
~# curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; http://cm.cla.ncloud.com/removeCla | &lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_05.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Agent 삭제 명령어를 실행하면 아래와 같이 &lt;strong&gt;Success Remove Agent&lt;/strong&gt; 메시지가 출력됩니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_10.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;windows-서버-로그-수집-해제&quot;&gt;Windows 서버 로그 수집 해제&lt;/h4&gt;
&lt;p&gt;마찬가지로 서버를 선택하고 [수집 해제] 버튼을 클릭합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_22.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;로그 수집 해제를 위한 가이드에서 로그 수집 Agent 삭제 명령어를 복사합니다.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# VPC 환경&lt;/span&gt;
Invoke-Expression &lt;span class=&quot;k&quot;&gt;$((&lt;/span&gt;New-Object System.Net.WebClient&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.DownloadString&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://cm.vcla.ncloud.com/removewinCla&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Classic 환경&lt;/span&gt;
Invoke-Expression &lt;span class=&quot;k&quot;&gt;$((&lt;/span&gt;New-Object System.Net.WebClient&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.DownloadString&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://cm.cla.ncloud.com/removewinCla&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_18.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Agent 삭제 명령어를 실행하면 아래와 같이 &lt;strong&gt;Remove Agent&lt;/strong&gt; 메시지가 출력됩니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_19.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;windows-서버-agent-삭제-오류-상황&quot;&gt;Windows 서버 Agent 삭제 오류 상황&lt;/h4&gt;
&lt;p&gt;Windows 서버에서 Agent 삭제를 시도할 때 아래와 같이 오류 메시지가 발생하는 경우가 있습니다.&lt;br /&gt;
이때는 당황하지 마시고, Agent 삭제 명령어를 다시 한번 실행하면 됩니다.&lt;/p&gt;

&lt;p&gt;오류의 원인 : 로그 수집 설정에서 EventLog만 선택했을 경우 발생합니다.&lt;br /&gt;
로그 수집 Agent는 윈도 이벤트 로그 수집을 위한 winlogbeat와 그 외 로그를 수집하기 위한 filebeat 두가지가 설치되는데, EventLog만 수집하도록 설정할 경우 filebeat는 실행되지 않습니다. 
그 상태에서 Agent를 삭제하려고 하면 실행중이 아닌 filebeat를 실행 중지 시키려고 시도하게 되고, 결국 오류가 발생합니다.&lt;br /&gt;
그러므로 심각한 오류는 아니고 만약을 위해 Agent 삭제 명령어를 한번 더 실행시키는 것으로 문제는 해결됩니다.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Stop-Service : Cannot find any service with service name &lt;span class=&quot;s1&quot;&gt;'filebeat'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_analytics_cloud_log_analytics_guide_21.png&quot; alt=&quot;Ncloud(네이버 클라우드) Cloud Log Analytics를 설정하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;참고-url&quot;&gt;참고 URL&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;Cloud Log Analytics 사용 가이드
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://guide.ncloud-docs.com/docs/cla-cla-1-1&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://guide.ncloud-docs.com/docs/cla-cla-1-1&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;blockquote&gt;
  &lt;p&gt;문서 최종 수정일 : 2021-12-14&lt;/p&gt;
&lt;/blockquote&gt;</content><author><name>{&quot;name&quot;=&gt;nil, &quot;email&quot;=&gt;nil, &quot;twitter&quot;=&gt;nil}</name></author><summary type="html">개요 Cloud Log Analytics는 Ncloud(네이버 클라우드)가 제공하는 여러 서비스에서 발생하는 다양한 로그들을 한 곳에 모아 저장하고 손쉽게 분석할 수 있는 서비스로, 검색 기능을 이용해 여러 종류의 로그를 한 곳에서 한번에 조회하고 분석할 수 있어 효과적인 로그 관리가 가능합니다.</summary></entry><entry><title type="html">MySQL 복구 시 ERROR 1227 (42000) 문제 원인과 해결방법</title><link href="https://docs.3rdeyesys.com/5.database/ncloud_database_cdb_mysql_restore_error_1227_troubleshooting/" rel="alternate" type="text/html" title="MySQL 복구 시 ERROR 1227 (42000) 문제 원인과 해결방법" /><published>2021-12-02T00:00:00+09:00</published><updated>2021-12-02T00:00:00+09:00</updated><id>https://docs.3rdeyesys.com/5.database/ncloud_database_cdb_mysql_restore_error_1227_troubleshooting</id><content type="html" xml:base="https://docs.3rdeyesys.com/5.database/ncloud_database_cdb_mysql_restore_error_1227_troubleshooting/">&lt;h2 id=&quot;개요&quot;&gt;개요&lt;/h2&gt;
&lt;p&gt;네이버 클라우드(Ncloud) Cloud DB for MySQL을 사용하면서 백업 데이터를 복구 하려고 할 때 ERROR 1227 (42000) 오류가 발생하는 경우가 있습니다. 
오류 메시지로만 보면 계정 권한에 문제가 있는 것처럼 보이는데 정확하게 문제 원인이 무엇인지, 그리고 해결방법은 어떤 것이 있는지 정리해보겠습니다.&lt;/p&gt;

&lt;h2 id=&quot;오류-메시지&quot;&gt;오류 메시지&lt;/h2&gt;
&lt;p&gt;전체 오류 메시지는 아래와 같습니다.&lt;br /&gt;
이 오류 메시지의 원인은 크게 2가지로 구분할 수 있는데, 상황에 따라 각각의 원인 1가지에 해당하는 경우도 있고, 2가지 원인이 모두 해당되는 경우도 있습니다.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ERROR 1227 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;42000&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at line 77: Access denied&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; you need &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;at least one of&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; the SUPER privilege&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;this operation
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;원인-1&quot;&gt;원인 1&lt;/h2&gt;
&lt;p&gt;첫번째 원인은 GTID(global transaction identifier)와 관련되어 있습니다.&lt;br /&gt;
네이버 클라우드(Ncloud) Cloud DB for MySQL 상품은 GTID(Global Transaction IDentifier)를 사용하는데, 
보통의 mysql db 복구(Restore)는 GTID를 사용하지 않는 방법이기 때문에 백업(Backup) 단계에서 [&lt;strong&gt;–set-gtid-purged=OFF&lt;/strong&gt;] 옵션을 추가해야 하는데 이 옵션을 사용하지 않았기 때문입니다.&lt;/p&gt;

&lt;h2 id=&quot;gtid-란&quot;&gt;GTID 란?&lt;/h2&gt;
&lt;p&gt;GTID는 Global Transaction Identifier의 약자로 MySQL 복제에서 서버의 각 트랜잭션을 구분하는 고유한 식별자입니다. 
GTID는 모든 트랜잭션과 1:1 관계이며, GTID를 활용하면 복제본으로 장애 조치, 계층적 복제, 특정 시점으로 백업 복구하는 등의 작업을 더 쉽게 구현할 수 있으며, 오류 발생 빈도도 줄일 수 있습니다.&lt;/p&gt;

&lt;h2 id=&quot;오류-상황-재현&quot;&gt;오류 상황 재현&lt;/h2&gt;
&lt;p&gt;아래와 같이 서버에서 mysqldump 명령으로 Cloud DB for MySQL DB를 백업 받는 상황을 가정해보겠습니다. 여기서는 [&lt;strong&gt;–set-gtid-purged=OFF&lt;/strong&gt;] 옵션을 사용하지 않았습니다.&lt;br /&gt;
[&lt;strong&gt;–set-gtid-purged=OFF&lt;/strong&gt;] 옵션을 사용하지 않고, 백업을 받으면 백업은 정상 진행되지만, 아래와 같이 [&lt;strong&gt;–set-gtid-purged=OFF&lt;/strong&gt;] 해야 한다는 Warning 메시지가 표시됩니다.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;~# mysqldump &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; user &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; db-......vpc-cdb.ntruss.com &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; /var/lib/mysql/mysql.sock &lt;span class=&quot;nt&quot;&gt;--single-transaction&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--routines&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--triggers&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--events&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--databases&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; dumpfile1.sql
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_database_cdb_mysql_restore_error_1227_troubleshooting_01.png&quot; alt=&quot;네이버 클라우드 Cloud DB for MySQL 복구(Restore)시에 발생하는 오류 ERROR 1227 (42000) 문제 원인과 해결방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;위에서 생성한 [&lt;strong&gt;–set-gtid-purged=OFF&lt;/strong&gt;] 옵션을 사용하지 않은 백업 파일(dumpfile1.sql)을 이용해서 복구(Restore)시에 아래와 같이 ERROR 1227 (42000) 오류가 발생하면서 복구가 되지 않습니다.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;~# mysql &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; db-......vpc-cdb.ntruss.com &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; user &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &amp;lt; ./dumpfile1.sql
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;../../images/ncloud_database_cdb_mysql_restore_error_1227_troubleshooting_03.png&quot; alt=&quot;네이버 클라우드 Cloud DB for MySQL 복구(Restore)시에 발생하는 오류 ERROR 1227 (42000) 문제 원인과 해결방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;해결-방법-1&quot;&gt;해결 방법 1&lt;/h2&gt;
&lt;p&gt;이번에는 Warning 메시지에 나온 것처럼 [&lt;strong&gt;–set-gtid-purged=OFF&lt;/strong&gt;] 옵션을 사용해서 백업을 받아 보겠습니다.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;~# mysqldump &lt;span class=&quot;nt&quot;&gt;--set-gtid-purged&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;OFF &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; user &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; db-......vpc-cdb.ntruss.com &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; /var/lib/mysql/mysql.sock &lt;span class=&quot;nt&quot;&gt;--single-transaction&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--routines&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--triggers&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--events&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--databases&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; dumpfile2.sql
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_database_cdb_mysql_restore_error_1227_troubleshooting_02.png&quot; alt=&quot;네이버 클라우드 Cloud DB for MySQL 복구(Restore)시에 발생하는 오류 ERROR 1227 (42000) 문제 원인과 해결방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;[&lt;strong&gt;–set-gtid-purged=OFF&lt;/strong&gt;] 옵션을 사용해서 생성한 백업 파일(dumpfile2.sql)을 이용해서 복구를 하면 아래와 같이 문제없이 복구가 잘됩니다.&lt;br /&gt;
그런데 이렇게 옵션을 적용해도 동일한 오류가 발생하는 경우가 있는데 이에 대해서는 아래쪽 [원인 2]에서 확인해보겠습니다.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;~# mysql &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; db-......vpc-cdb.ntruss.com &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; user &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &amp;lt; ./dumpfile2.sql
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;../../images/ncloud_database_cdb_mysql_restore_error_1227_troubleshooting_04.png&quot; alt=&quot;네이버 클라우드 Cloud DB for MySQL 복구(Restore)시에 발생하는 오류 ERROR 1227 (42000) 문제 원인과 해결방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;해결-방법-2&quot;&gt;해결 방법 2&lt;/h2&gt;
&lt;p&gt;그런데 서비스를 하다 보면 DB 사이즈가 너무 커서 다시 백업을 진행하기 어렵다던가 하는 경우가 있습니다. 이럴 때는 백업 파일에 있는 GTID 관련 내용을 삭제하고 복구하시면 문제가 해결됩니다.&lt;br /&gt;
백업 파일 상단과 하단에 각각 아래와 같은 코드가 포함되어 있는데 이 내용을 삭제하거나 주석처리한 후에 복구를 시도하면 문제 없이 복구가 완료됩니다.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# 백업 파일 상단에 위치&lt;/span&gt;
SET @MYSQLDUMP_TEMP_LOG_BIN &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; @@SESSION.SQL_LOG_BIN&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
SET @@SESSION.SQL_LOG_BIN&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# 백업 파일 하단에 위치&lt;/span&gt;
SET @@GLOBAL.GTID_PURGED&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'207****-4***-7**-9*****c:1-12,
2****-4**-9**-b**-d*****:1-19'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;원인-2&quot;&gt;원인 2&lt;/h2&gt;
&lt;p&gt;위에서 설명한 [&lt;strong&gt;–set-gtid-purged=OFF&lt;/strong&gt;]을 적용한 백업 파일을 이용해서 복구를 진행해도 동일한 오류가 발생하는 경우가 있는데 
원인은 Trigger, Stored Routines (Procedures and Functions), View, Event 생성과 관련된 [&lt;strong&gt;DEFINER&lt;/strong&gt;] 권한 때문입니다.  즉,  &lt;strong&gt;Trigger, Stored Routines (Procedures and Functions), View, Event를 생성한 계정과 DB 복구를 시도하는 계정이 다른 경우에 발생하는 문제&lt;/strong&gt;입니다.&lt;/p&gt;

&lt;p&gt;[원인 1]에서는 복구를 시도할 때 [user] 계정을 사용했었는데 이 [user]계정으로 Trigger, Stored Routines (Procedures and Functions), View, Event 등을 생성한 상황에서 다른 계정 [new_user]를 이용해서 복구를 시도하는 상황을 가정보겠습니다. 
[new_user] 계정으로 복구를 시도하면 [&lt;strong&gt;–set-gtid-purged=OFF&lt;/strong&gt;]을 적용한 백업 파일(dumpfile2.sql)을 이용했음에도 동일한 ERROR 1227 (42000) 오류가 발생하는 것을 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_database_cdb_mysql_restore_error_1227_troubleshooting_05.png&quot; alt=&quot;네이버 클라우드 Cloud DB for MySQL 복구(Restore)시에 발생하는 오류 ERROR 1227 (42000) 문제 원인과 해결방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;아래와 같이 MySQL은 보안 강화를 위해 Trigger, Stored Routines (Procedures and Functions), View, Event를 처음 생성한 계정을 [&lt;strong&gt;DEFINER&lt;/strong&gt;]로 명시해 둠으로써 다른 계정으로 접근하지 못하도록 하는 것이 기본 설정이 되어 있습니다.&lt;br /&gt;
그러므로 DB 복구를 시도할 때는 [&lt;strong&gt;DEFINER&lt;/strong&gt;] 관련 내용을 삭제하거나 동일한 계정 또는 SUPER privilege를 가진 계정으로 복구해야 합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_database_cdb_mysql_restore_error_1227_troubleshooting_08.png&quot; alt=&quot;네이버 클라우드 Cloud DB for MySQL 복구(Restore)시에 발생하는 오류 ERROR 1227 (42000) 문제 원인과 해결방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;해결-방법-1-1&quot;&gt;해결 방법 1&lt;/h2&gt;
&lt;p&gt;첫번째 해결 방법은 백업 파일에서 [&lt;strong&gt;DEFINER&lt;/strong&gt;] 관련 내용을 모두 찾아서 삭제하는 방법이 있습니다. 
여기서는 대표적으로 FUNCTION, PROCEDURE, VIEW에 해당하는 예시를 살펴보겠습니다.&lt;/p&gt;

&lt;h4 id=&quot;function&quot;&gt;FUNCTION&lt;/h4&gt;
&lt;p&gt;DB에서 FUNCTION을 사용했다면 아래와 같이 FUNCTION 생성 코드에 [&lt;strong&gt;CREATE DEFINER=`user`@`%` FUNCTION&lt;/strong&gt;]처럼 계정이 표시되는데, 여기서 [&lt;strong&gt;DEFINER=`user`@`%`&lt;/strong&gt;] 이 부분을 삭제하시면 됩니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_database_cdb_mysql_restore_error_1227_troubleshooting_06.png&quot; alt=&quot;네이버 클라우드 Cloud DB for MySQL 복구(Restore)시에 발생하는 오류 ERROR 1227 (42000) 문제 원인과 해결방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;procedure&quot;&gt;PROCEDURE&lt;/h4&gt;
&lt;p&gt;DB에서 PROCEDURE를 사용했다면 아래와 같이 PROCEDURE 생성 코드에 [&lt;strong&gt;CREATE DEFINER=`user`@`%` PROCEDURE&lt;/strong&gt;]처럼 계정이 표시되는데, 여기서 [&lt;strong&gt;DEFINER=`user`@`%`&lt;/strong&gt;] 이 부분을 삭제하시면 됩니다.
&lt;img src=&quot;../../images/ncloud_database_cdb_mysql_restore_error_1227_troubleshooting_07.png&quot; alt=&quot;네이버 클라우드 Cloud DB for MySQL 복구(Restore)시에 발생하는 오류 ERROR 1227 (42000) 문제 원인과 해결방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;view&quot;&gt;VIEW&lt;/h4&gt;
&lt;p&gt;DB에서 VIEW를 사용했다면 아래와 같이 VIEW 생성 코드에 [&lt;strong&gt;/*!50013 DEFINER=`user`@`%` SQL SECURITY DEFINER */&lt;/strong&gt;]처럼 계정이 표시되는데, 여기서는 이 라인을 모두 삭제하시면 됩니다.
&lt;img src=&quot;../../images/ncloud_database_cdb_mysql_restore_error_1227_troubleshooting_08.png&quot; alt=&quot;네이버 클라우드 Cloud DB for MySQL 복구(Restore)시에 발생하는 오류 ERROR 1227 (42000) 문제 원인과 해결방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;해결-방법-2-1&quot;&gt;해결 방법 2&lt;/h2&gt;
&lt;p&gt;두번째 해결 방법은 백업 파일 [&lt;strong&gt;DEFINER=&lt;/strong&gt;]에 표시되어 있는 계정과 동일한 계정으로 복구를 진행하면 됩니다.&lt;/p&gt;

&lt;h2 id=&quot;참고-url&quot;&gt;참고 URL&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;Cloud DB for MySQL 백업, 복구 가이드
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://guide.ncloud-docs.com/docs/database-database-5-4&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://guide.ncloud-docs.com/docs/database-database-5-4&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;GTID를 이용한 Mysql 복제 가이드
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://dev.mysql.com/doc/refman/5.7/en/replication-gtids.html&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://dev.mysql.com/doc/refman/5.7/en/replication-gtids.html&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;GTID를 이용한 MariaDB 복제 가이드
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;http://mariadb.com/kb/en/gtid/&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;http://mariadb.com/kb/en/gtid/&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;MySQL Stored Object Access Control : DEFINER 안내
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://dev.mysql.com/doc/refman/5.7/en/stored-objects-security.html&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://dev.mysql.com/doc/refman/5.7/en/stored-objects-security.html&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;blockquote&gt;
  &lt;p&gt;문서 최종 수정일 : 2021-12-02&lt;/p&gt;
&lt;/blockquote&gt;</content><author><name>{&quot;name&quot;=&gt;nil, &quot;email&quot;=&gt;nil, &quot;twitter&quot;=&gt;nil}</name></author><summary type="html">개요 네이버 클라우드(Ncloud) Cloud DB for MySQL을 사용하면서 백업 데이터를 복구 하려고 할 때 ERROR 1227 (42000) 오류가 발생하는 경우가 있습니다. 오류 메시지로만 보면 계정 권한에 문제가 있는 것처럼 보이는데 정확하게 문제 원인이 무엇인지, 그리고 해결방법은 어떤 것이 있는지 정리해보겠습니다.</summary></entry><entry><title type="html">네이버 클라우드 Classic 환경 vs VPC 환경 비교</title><link href="https://docs.3rdeyesys.com/81.manage/ncp_manage_classic_vs_vpc_guide/" rel="alternate" type="text/html" title="네이버 클라우드 Classic 환경 vs VPC 환경 비교" /><published>2021-11-30T00:00:00+09:00</published><updated>2021-11-30T00:00:00+09:00</updated><id>https://docs.3rdeyesys.com/81.manage/ncp_manage_classic_vs_vpc_guide</id><content type="html" xml:base="https://docs.3rdeyesys.com/81.manage/ncp_manage_classic_vs_vpc_guide/">&lt;h2 id=&quot;개요&quot;&gt;개요&lt;/h2&gt;
&lt;p&gt;네이버 클라우드 (nCloud)에는 Classic과 VPC 이렇게 2가지의 환경이 있습니다.
각각의 특징을 장점을 중심으로 비교해보도록 하겠습니다.&lt;/p&gt;

&lt;h2 id=&quot;classic-환경-장점-요약&quot;&gt;Classic 환경 장점 요약&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;서로 다른 계정의 서버들 간에 사설 통신 가능&lt;/li&gt;
  &lt;li&gt;리전간 서버들의 사설 통신 가능 (한국, 미국, 싱가포르, 홍콩, 일본, 독일)&lt;/li&gt;
  &lt;li&gt;다양한 설치형 서버 이미지 이용 가능&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;vpc-환경-장점-요약&quot;&gt;VPC 환경 장점 요약&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;논리적으로 분리된 Network&lt;/li&gt;
  &lt;li&gt;사용자가 직접 Network 설계 가능&lt;/li&gt;
  &lt;li&gt;기존 고객의 데이터센터 네트워크와 유사하게 구현 가능&lt;/li&gt;
  &lt;li&gt;좀 더 상세하고, 높은 수준의 보안 설정 가능&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;classic-환경-장점-상세&quot;&gt;Classic 환경 장점 상세&lt;/h2&gt;
&lt;p&gt;위에서 요약한 장점들을 좀 더 상세하게 살펴보겠습니다.&lt;/p&gt;

&lt;h4 id=&quot;서로-다른-계정의-서버들-간에-사설-통신-가능&quot;&gt;서로 다른 계정의 서버들 간에 사설 통신 가능&lt;/h4&gt;
&lt;p&gt;사용자가 2개 이상의 계정을 보유하고 있을 경우 각 계정에 생성된 서버들간에 사설 통신을 할 수 있습니다.&lt;/p&gt;

&lt;h4 id=&quot;리전간-서버들의-사설-통신-가능&quot;&gt;리전간 서버들의 사설 통신 가능&lt;/h4&gt;
&lt;p&gt;현재 네이버 클라우드는 한국, 미국, 싱가포르, 홍콩, 일본, 독일 이렇게 6개의 리전으로 서비스가 구분되어 있는데, 각 리전에 생성된 서버들끼리 사설 통신을 할 수 있습니다.&lt;/p&gt;

&lt;h4 id=&quot;다양한-설치형-서버-이미지-이용-가능&quot;&gt;다양한 설치형 서버 이미지 이용 가능&lt;/h4&gt;
&lt;p&gt;Classic 환경에서는 LAMP, Wordpress 등 사용자들이 편하게 각 종 애플리케이션과 DB가 미리 설치된 서버를 쉽게 생성할 수 있도록 설치형 서버 이미지를 제공하고 있습니다. 
지원하는 주요 이미지는 다음과 같습니다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Jenkins, Tensorflow, RabbitMQ, Pinpoint, LAMP, WordPress, Magento, Drupal, Joomla!, Shadowsocks, LEMP, Hugo, Gitlab CE, Node.js, Superset, Tomcat, JEUS, WebtoB, Gradle&lt;/li&gt;
  &lt;li&gt;MySQL, MSSQL, Cubrid, PostgreSQL, MariaDB, Redis, Tibero&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;vpc-환경-장점-상세&quot;&gt;VPC 환경 장점 상세&lt;/h2&gt;
&lt;p&gt;위에서 요약한 장점들을 좀 더 상세하게 살펴보겠습니다.&lt;/p&gt;

&lt;h4 id=&quot;논리적으로-분리된-network&quot;&gt;논리적으로 분리된 Network&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;논리적으로 분리된 Network 체계를 제공하기 때문에 다른 이용자와의 간섭 없이 더 안전하고, 투명한 환경을 구현할 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;사용자가-직접-network-설계-가능&quot;&gt;사용자가 직접 Network 설계 가능&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;네트워크 서브넷(Subnet) 기능을 통해 용도에 따라 네트워크를 세분화하여 서비스 맞춤형 네트워크를 사용자가 직접 구성하실 수 있습니다&lt;/li&gt;
  &lt;li&gt;Load Balancer가 Application Load Balancer / Network Load Balancer / Network Proxy Load Balancer 등 3가지로 구분되어 있어, 고객이 각자의 서비스 환경에 최적화된 Load Balancer를 선택할 수 있습니다.&lt;/li&gt;
  &lt;li&gt;원하는 사설 IP 대역을 직접 할당할 수 있습니다. 
그러므로 사용해야 하는 사설 IP대역이 정해져 있어 변경할 수 없거나, 서버의 사설 IP를 변경하기 어려운 경우에도 VPC 환경에서는 원하는 대역의 원하는 IP를 직접 부여할 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;기존-고객의-데이터센터-네트워크와-유사하게-구현-가능&quot;&gt;기존 고객의 데이터센터 네트워크와 유사하게 구현 가능&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;기존 고객 데이터센터 네트워크와 유사하게 구현 가능합니다.
즉, 기존에 AWS를 사용하고 있었던 고객은 AWS는 VPC 환경만 제공하기 때문에 거의 비슷하게 구현 가능합니다.
또한 온프레미스 환경의 IDC 센터를 이용했던 고객이 클라우드 환경으로 마이그레이션해야 할 때 VPC 환경은 기존의 구조를 거의 그대로 구현해서 마이그레이션할 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;좀-더-상세하고-높은-수준의-보안-설정-가능&quot;&gt;좀 더 상세하고, 높은 수준의 보안 설정 가능&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;서버 측면에서 접근 제어를 위한 ACG(Access Control Group) 외에도,  네트워크 서브넷 측면에서 접근 제어를 할 수 있도록 NACL(Network Access Control List)을 제공합니다. 
이처럼 여러가지 접근제어 기능을 이용해 클라우드 상에서 발생할 수 있는 다양한 공격에 대한 대비가 가능합니다.&lt;/li&gt;
  &lt;li&gt;ACG, NACL등의 네트워크 접근제어 설정에서 Inbound, Outbound 각각에 대한 제어 설정 등 상세한 보안 설정을 직접 할 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;vpc-환경-활용사례&quot;&gt;VPC 환경 활용사례&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;외부와 인터넷 연결이 필요한 서브넷과 이와 별개로 중요 데이터를 저장하기 위해 외부 접속을 최소화하기 위한 서브넷을 구성하는 경우&lt;br /&gt;
하나의 서브넷에 인터넷 게이트웨이를 연결하여 프런트-엔드(Front-end) 전용 서브넷을 구성하고, 다른 하나의 서브넷에는 NAT 게이트웨이를 연결하여 백-엔드(Back-end)용 서브넷으로 활용&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Cloud Connect만을 이용하여 접근할 수 있는 서브넷을 구성하는 경우&lt;br /&gt;
 Cloud Connect를 이용하여 On-Premise에 있는 고객의 전산망을 클라우드로 확장한 하이브리드 클라우드 구성&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;외부와 인터넷 연결이 필요한 서브넷과 이와 별개로 외부 인터넷 연결을 차단하고 VPN을 통해 On-Premise에서만 접근할 수 있는 서브넷을 구성하는 경우&lt;br /&gt;
하나의 서브넷은 외부와 연결되는 일반 구성으로 하고, 다른 하나의 서브넷에 IPsec VPN을 연결하여 VPN 전용 서브넷(VPN Only Subnet)을 구성하는 방식&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;다른 두개의 서비스를 각각 다른 사설 IP대역에서 서비스하려는 경우&lt;br /&gt;
VPC를 2개 생성해서 각각 다른 사설 IP 대역을 할당해서 구성 가능&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;classic-vs-vpc-선택&quot;&gt;Classic vs VPC 선택&lt;/h2&gt;

&lt;h4 id=&quot;classic-선택&quot;&gt;Classic 선택&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;구축하려는 서비스 규모가 작으며 네트워크 설정은 신경 쓰고 싶지 않은 경우는 Classic 환경&lt;/li&gt;
  &lt;li&gt;리전간 서버끼리 사설통신이 필요하다면 (ex. DB 한국리전, 서비스서버 일본리전) Classic 환경&lt;/li&gt;
  &lt;li&gt;다양한 설치형 서버 이미지들이 필요하다면 Classic 환경&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;vpc-선택&quot;&gt;VPC 선택&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;네트워크 세분화및  서비스에 별도 사설 대역이 필요한 경우는 VPC 환경&lt;/li&gt;
  &lt;li&gt;서버, 네트워크 통신의 inbound, outbound를 직접 통제하고 싶은 경우는 VPC 환경&lt;/li&gt;
  &lt;li&gt;좀 더 다양한 기능을 지원하는 상품을 이용하고자 할때는 VPC환경&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;참고-url&quot;&gt;참고 URL&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;VPC 제품 설명
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://www.ncloud.com/product/networking/vpc&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://www.ncloud.com/product/networking/vpc&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;VPC 사용 가이드
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://guide.ncloud-docs.com/docs/ko/networking-vpc-vpcoverview&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://guide.ncloud-docs.com/docs/ko/networking-vpc-vpcoverview&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;blockquote&gt;
  &lt;p&gt;문서 최종 수정일 : 2021-12-03&lt;/p&gt;
&lt;/blockquote&gt;</content><author><name>{&quot;name&quot;=&gt;nil, &quot;email&quot;=&gt;nil, &quot;twitter&quot;=&gt;nil}</name></author><summary type="html">개요 네이버 클라우드 (nCloud)에는 Classic과 VPC 이렇게 2가지의 환경이 있습니다. 각각의 특징을 장점을 중심으로 비교해보도록 하겠습니다.</summary></entry><entry><title type="html">VPC Peering 생성 가이드</title><link href="https://docs.3rdeyesys.com/2.networking/ncp_networking_vpc_peering_guide/" rel="alternate" type="text/html" title="VPC Peering 생성 가이드" /><published>2021-11-22T00:00:00+09:00</published><updated>2021-11-22T00:00:00+09:00</updated><id>https://docs.3rdeyesys.com/2.networking/ncp_networking_vpc_peering_guide</id><content type="html" xml:base="https://docs.3rdeyesys.com/2.networking/ncp_networking_vpc_peering_guide/">&lt;h2 id=&quot;개요&quot;&gt;개요&lt;/h2&gt;
&lt;p&gt;VPC(virtural Private Cloud)는 퍼블릭클라우드상에서 제공되는 사설 가상 네트워크 입니다. 계정당 3개의 VPC를 만들수 있으며 다른 VPC 네트워크와 논리적으로 분리되어 있어 독립적인 네트워크 환경을 구현할 수 있습니다.&lt;br /&gt;
그런데, 간혹 VPC 환경에서 분리되어 있는 VPC간의 통신이 필요할때가 있는데 이때 사용할 수 있는 서비스가 [&lt;strong&gt;VPC Peering&lt;/strong&gt;] 입니다. VPC Peering은 공인 아이피를 거치지 않고 Ncloud 내부 네트워크를 이용하여 VPN없이 VPC간 통신을 할수 있게 해주는 서비스 입니다.&lt;/p&gt;

&lt;h2 id=&quot;vpc-생성&quot;&gt;VPC 생성&lt;/h2&gt;
&lt;p&gt;우선 테스트에 사용할 VPC로 [test-vpc], [test2-vpc] 이렇게 2개를 준비했습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_01.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;subnet-생성&quot;&gt;Subnet 생성&lt;/h2&gt;

&lt;p&gt;이제 각 VPC에 서브넷을 생성합니다. [test-vpc]에는 [test-subnet(192.168.10.0/24)]으로 생성합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_07.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:700px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;[test2-vpc]에는 [test2-subnet(172.16.10.0/24)]으로 생성합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_08.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:700px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;생성된 Subnet은 다음과 같습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_09.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;vpc-peering-생성&quot;&gt;VPC Peering 생성&lt;/h2&gt;
&lt;p&gt;네이버 클라우드(Ncloud) 콘솔에서 [Networking] -&amp;gt; [VPC] -&amp;gt; [VPCPeering] 메뉴로 이동해서 [VPC peerig 생성] 버튼을 클릭합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_02.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;① 이름을 적고&lt;/li&gt;
  &lt;li&gt;② 요청 VPC는 [testVPC]를 선택&lt;/li&gt;
  &lt;li&gt;③ 수락 VPC는 [내계정], [test2VPC]를 선택&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;설정이 끝났으면 생성버튼을 클릭합니다.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;다른 계정의 VPC와 연결하는 경우는 아래쪽에서 살펴보겠습니다.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_03.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:700px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;마지막으로 VPC Peering 요청 내용을 확인하고 [확인] 버튼을 클릭합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_17.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:500px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;[test-vpc] -&amp;gt; [test2-vpc]로 설정된 VPC Peering을 아래와 같이 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_04.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;역방향-설정-추가&quot;&gt;역방향 설정 추가&lt;/h4&gt;
&lt;p&gt;그런데 VPC peering은 단방향 통신이기에 TCP, ICMP 등의 양방향 통신을 하는 프로토콜을 이용하려면 역방향 즉, [test2-vpc] -&amp;gt; [test-vpc]로 설정된 VPC Peering도 추가해야 합니다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;① 이름을 적고&lt;/li&gt;
  &lt;li&gt;② 요청 VPC에는 test2VPC를 선택&lt;/li&gt;
  &lt;li&gt;③ 수락 VPC에는 testVPC를 선택&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_05.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:700px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;VPC Peering 요청 내용을 확인하고 [확인] 버튼을 클릭합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_18.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:500px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;아래와 같이 [test-vpc] -&amp;gt; [test2-vpc] , [test2-vpc] -&amp;gt; [test-vpc] 2가지 VPC Peering을 모두 생성했으므로 양방향 통신이 가능하게 되었습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_06.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;route-table-설정&quot;&gt;Route Table 설정&lt;/h2&gt;

&lt;p&gt;이제 통신할 서브넷 혹은 서버의 아이피를 Route Table 설정에 추가 합니다. 여기서는 서브넷을 추가하도록 하겠습니다.&lt;/p&gt;

&lt;p&gt;우선 [VPC] - [Route Table]에서, [test-vpc-default-public-table]의 [Routes 설정]을 클릭합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_11.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Destination에는 [test2-subnet]의 아이피 대역을 입력 (서버의 아이피로 입력해도 됨)&lt;/li&gt;
  &lt;li&gt;Target Type은 [VPCPEERING]을 선택&lt;/li&gt;
  &lt;li&gt;Target Name은 [test-vpc-peering]을 선택&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_12.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;다음으로 [test2-vpc-default-public-table]의 [Routes 설정]을 클릭합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_13.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Destination에는 [test-subnet]의 아이피 대역을 입력 (서버의 아이피로 입력해도 됨)&lt;/li&gt;
  &lt;li&gt;Target Type은 [VPCPEERING]을 선택&lt;/li&gt;
  &lt;li&gt;Target Name은 [test2-vpc-peering]을 선택&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_14.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;서버-준비&quot;&gt;서버 준비&lt;/h2&gt;
&lt;p&gt;아래와 같이 테스트로 사용할 서버 2대를 준비했습니다.&lt;br /&gt;
테스트는 [test-vpc]에 위치한 [test-vpc-peering-svr]서버 -&amp;gt; [test2-vpc]에 위치한 [test2-vpc-peering-svr]로 접속 시도를 해보겠습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_15.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;acg-설정&quot;&gt;ACG 설정&lt;/h2&gt;
&lt;p&gt;ACG를 설정하지 않고 [test-vpc-peering-svr] -&amp;gt; [test2-vpc-peering-svr]로 접속 시도를 하면 접속이 되지 않는 것을 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_19.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;[test2-vpc-peering-svr]로 접속할 것이므로 해당 서버에 설정된 acg인 [test2-vpc-default-acg]를 선택하고 [ACG 설정] 버튼을 클릭합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_20.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;접근소스에는 [test-vpc-peering-svr] 서버의 subnet 대역인 [192.168.10.0/24]를 입력하고, 포트는 22번 포트를 입력하고 추가해서 적용합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_21.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;접속-테스트&quot;&gt;접속 테스트&lt;/h2&gt;
&lt;p&gt;ACG 설정까지 완료하고 나서 다시 접속 테스트를 해보면 아래와 같이 접속이 잘 되는 것을 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_22.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;다른-계정-vpc-연결&quot;&gt;다른 계정 VPC 연결&lt;/h2&gt;
&lt;p&gt;위에서는 동일한 내 계정에 생성된 VPC들 간의 Peering을 살펴보았는데, 아래에서는 다른 계정에 생성된 VPC와 연결할 때의 화면을 살펴보겠습니다.&lt;/p&gt;

&lt;p&gt;VPC Peering 생성 화면에서 [다른 계정]을 선택하면 아래와 같이 [로그인 ID (이메일)], [VPC ID], [VPC 이름]을 입력하게 됩니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_23.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:700px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;마찬가지로 VPC Peering 요청 내용을 확인하고 [확인] 버튼을 클릭합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_24.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:500px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;다음으로 수락을 요청받은 다른 계정의 VPC Peering 화면에 가면 요청 내용을 확인할 수 있고, 요청 응답에서 [수락] 버튼을 클릭합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_25.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;한번 더 VPC Peering 연결 요청을 수락할 것인지 확인하는 창이 나타납니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_26.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:500px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;수락하고 나면 역방향의 VPC Peering 연결을 생성해야 한다는 안내와 함께 역방향 VPC Peering 생성 화면이 나타납니다.&lt;br /&gt;
역방향은 위의 설정과 반대로 진행하면 되고, 그 이후에는 내 계정에서 설정했던 것과 마찬가지로 설정하시면 완료됩니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_networking_vpc_peering_guide_27.png&quot; alt=&quot;네이버 클라우드 VPC 환경에서 VPC Peering 생성 가이드 &quot; style=&quot;width:500px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;제한사항&quot;&gt;제한사항&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;VPC Peering은 연결하려는 VPC들의 IP주소 대역이 달라야 합니다. 일치되거나 중첩되는 대역이 있으면 설정되지 않습니다.&lt;/li&gt;
  &lt;li&gt;VPC Peering은 단방향입니다. TCP등 양방향 통신을 해야 하는 경우에는 요청 / 수락 VPC를 맞바꾸어 역방향 Peering도 추가 생성해야 합니다.&lt;/li&gt;
  &lt;li&gt;VPC Peering은 전이적 연결 관계를 지원하지 않습니다. 즉, Peering된 VPC를 통하여 다른 VPC 혹은 외부로 통신하는 것은 불가능 합니다.&lt;/li&gt;
  &lt;li&gt;VPC Peering은 동일한 리전 내 VPC 끼리만 연결할 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;참고-url&quot;&gt;참고 URL&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;VPC Peering 가이드
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://guide.ncloud-docs.com/docs/networking-vpc-vpcdetailedpeering&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://guide.ncloud-docs.com/docs/networking-vpc-vpcdetailedpeering&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;VPC Peering 설정 시나리오
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://guide.ncloud-docs.com/docs/networking-vpc-vpcuserscenario4&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://guide.ncloud-docs.com/docs/networking-vpc-vpcuserscenario4&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;blockquote&gt;
  &lt;p&gt;문서 최종 수정일 : 2021-11-25&lt;/p&gt;
&lt;/blockquote&gt;</content><author><name>{&quot;name&quot;=&gt;nil, &quot;email&quot;=&gt;nil, &quot;twitter&quot;=&gt;nil}</name></author><summary type="html">개요 VPC(virtural Private Cloud)는 퍼블릭클라우드상에서 제공되는 사설 가상 네트워크 입니다. 계정당 3개의 VPC를 만들수 있으며 다른 VPC 네트워크와 논리적으로 분리되어 있어 독립적인 네트워크 환경을 구현할 수 있습니다. 그런데, 간혹 VPC 환경에서 분리되어 있는 VPC간의 통신이 필요할때가 있는데 이때 사용할 수 있는 서비스가 [VPC Peering] 입니다. VPC Peering은 공인 아이피를 거치지 않고 Ncloud 내부 네트워크를 이용하여 VPN없이 VPC간 통신을 할수 있게 해주는 서비스 입니다.</summary></entry><entry><title type="html">Archive Storage CLI 사용 가이드 - Windows 환경</title><link href="https://docs.3rdeyesys.com/4.storage/ncp_storage_archive_storage_cli_windows_guide/" rel="alternate" type="text/html" title="Archive Storage CLI 사용 가이드 - Windows 환경" /><published>2021-11-19T00:00:00+09:00</published><updated>2021-11-19T00:00:00+09:00</updated><id>https://docs.3rdeyesys.com/4.storage/ncp_storage_archive_storage_cli_windows_guide</id><content type="html" xml:base="https://docs.3rdeyesys.com/4.storage/ncp_storage_archive_storage_cli_windows_guide/">&lt;h2 id=&quot;개요&quot;&gt;개요&lt;/h2&gt;
&lt;p&gt;네이버 클라우드(Ncloud) Archive Storage CLI를 Windows 환경에서 사용하는 방법에 대해 정리해보겠습니다.&lt;/p&gt;

&lt;h2 id=&quot;cli-정보&quot;&gt;CLI 정보&lt;/h2&gt;
&lt;p&gt;Archive Storage가 OepnStack으로 구성되어 있고, Client는 Python 기반의 Client를 사용하게 됩니다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;python-keystoneclient : 3.17.0&lt;/li&gt;
  &lt;li&gt;python-swiftclient : 3.6.0&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;python-다운로드&quot;&gt;Python 다운로드&lt;/h2&gt;
&lt;p&gt;먼저 Python을 다운로드 합니다. 권장하는 버전은 3.6 이상입니다. 여기서는 3.9를 설치하겠습니다.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.python.org/downloads/&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://www.python.org/downloads/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/python_install_01.png&quot; alt=&quot;python 설치 화면&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;python-설치&quot;&gt;Python 설치&lt;/h2&gt;

&lt;h4 id=&quot;path-추가&quot;&gt;PATH 추가&lt;/h4&gt;
&lt;p&gt;Python 설치 시작화면에 PATH에 python을 추가하는 옵션이 있습니다.&lt;br /&gt;
“&lt;strong&gt;Add Python 3.9 to PATH&lt;/strong&gt;” 옵션을 선택하고 설치를 시작하면 됩니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/python_install_02.png&quot; alt=&quot;python 설치 화면&quot; style=&quot;width:660px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;path-문자-길이-제한-해제&quot;&gt;PATH 문자 길이 제한 해제&lt;/h4&gt;
&lt;p&gt;Windows에는 기본설정에 파일경로가 최대 260자로 제한되어 있는데, 이 제한을 풀것인지 확인하는 과정입니다.&lt;br /&gt;
“&lt;strong&gt;Disable path length limit&lt;/strong&gt;” 옵션이 나오는데, 특별한 문제가 없다면 해제하고 가면 됩니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/python_install_03.png&quot; alt=&quot;python 설치 화면&quot; style=&quot;width:660px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;cli-client-설치&quot;&gt;CLI Client 설치&lt;/h2&gt;

&lt;h4 id=&quot;python-keystoneclient--3170-설치&quot;&gt;python-keystoneclient : 3.17.0 설치&lt;/h4&gt;
&lt;p&gt;우선 OepnStack 서비스의 인증을 담당하는  KeyStone Client를 설치합니다.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pip &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;python-keystoneclient&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;3.17.0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_cli_windows_guide_01.png&quot; alt=&quot;네이버 클라우드 Archive Storage CLI를 Windows 환경에서 사용하는 방법에 대한 가이드&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;python-swiftclient--360-설치&quot;&gt;python-swiftclient : 3.6.0 설치&lt;/h4&gt;
&lt;p&gt;다음으로 실제 명령을 수행하는 Swift Client를 설치합니다.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pip &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;python-swiftclient&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;3.6.0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_cli_windows_guide_02.png&quot; alt=&quot;네이버 클라우드 Archive Storage CLI를 Windows 환경에서 사용하는 방법에 대한 가이드&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;client-설치-오류&quot;&gt;Client 설치 오류&lt;/h2&gt;
&lt;p&gt;Python Clinet를 설치하는 도중에 아래와 같은 메시지가 나타나면서 오류가 발생하는 경우가 있습니다. 
Microsoft Visual C++ Build Tools 등이 설치되어 있지 않아서 인데 설치하는 방법 2가지 중에서 하나를 선택해서 설치하시면 됩니다.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;error: Microsoft Visual C++ 14.0 is required. Get it with &lt;span class=&quot;s2&quot;&gt;&quot;Microsoft Visual C++ Build Tools&quot;&lt;/span&gt; : https://visualstudio.microsoft.com/downloads/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;fatal error C1083: 포함 파일을 열 수 없습니다. &lt;span class=&quot;s1&quot;&gt;'basetsd.h'&lt;/span&gt; : No such file or directory
error: &lt;span class=&quot;nb&quot;&gt;command&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'C:\\Program Files (x86)\\Microsoft Visual Studio\\....... .....\\cl.exe'&lt;/span&gt; failed with &lt;span class=&quot;nb&quot;&gt;exit &lt;/span&gt;code 2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_cli_windows_guide_21.png&quot; alt=&quot;네이버 클라우드 Archive Storage CLI를 Windows 환경에서 사용하는 방법에 대한 가이드&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;방법-1--build-tools-직접-설치&quot;&gt;방법 1 : Build Tools 직접 설치&lt;/h4&gt;
&lt;p&gt;첫번째 방법은 Build Tools를 따로 설치하는 방법입니다. 
아래 링크에서 [Microsoft Build Tools 2015 업데이트3]를 다운로드 받아서 설치하시면 되는데, [Visual Studio]가 설치되어 있는 경우에는 설치가 실패하기도 합니다.&lt;br /&gt;
이때는 아래에 나오는 두번째 방법으로 설치하시면 됩니다.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://visualstudio.microsoft.com/ko/vs/older-downloads/&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://visualstudio.microsoft.com/ko/vs/older-downloads/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_cli_windows_guide_03.png&quot; alt=&quot;네이버 클라우드 Archive Storage CLI를 Windows 환경에서 사용하는 방법에 대한 가이드&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;방법-2--visual-studio-installer-설치&quot;&gt;방법 2 : Visual Studio Installer 설치&lt;/h4&gt;
&lt;p&gt;Visual Studio가 설치되어 있는 경우에는 위 1번 방법으로 설치가 되지 않는 경우가 있으므로 Visual Studio Installer에서 설치하도록 하겠습니다.&lt;br /&gt;
[Visual Studio Installer]를 실행하셔서 설치된 Visual Studio 메뉴의 [수정] 버튼을 클릭합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_cli_windows_guide_04.png&quot; alt=&quot;네이버 클라우드 Archive Storage CLI를 Windows 환경에서 사용하는 방법에 대한 가이드&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;나타난 화면에서 [C++를 사용한 데스크톱 개발]을 선택하시고 오른쪽 [설치 세부정보]에서  다음 2가지를 선택해서 설치하시면 됩니다.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;MSVC vXXX - VS 20XX C++ x64/x86 빌드 도구&lt;/li&gt;
  &lt;li&gt;Windows 10 SDK&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_cli_windows_guide_05.png&quot; alt=&quot;네이버 클라우드 Archive Storage CLI를 Windows 환경에서 사용하는 방법에 대한 가이드&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;인증-토큰-생성&quot;&gt;인증 토큰 생성&lt;/h2&gt;
&lt;p&gt;CLI Client가 모두 설치되었으면 이제 접속을 위한 인증 토큰을 생성해야 합니다. 
인증 토큰을 생성하는 명령어는 다음과 같은데 여기에 필요한 값이 4가지 있습니다.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;swift &lt;span class=&quot;nt&quot;&gt;--os-auth-url&lt;/span&gt; https://kr.archive.ncloudstorage.com:5000/v3 &lt;span class=&quot;nt&quot;&gt;--auth-version&lt;/span&gt; 3 &lt;span class=&quot;nt&quot;&gt;--os-username&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;access_key_id&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--os-password&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;secret_key&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--os-user-domain-id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;domain_id&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--os-project-id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;project_id&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; auth
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h4 id=&quot;네이버-클라우드-api-인증키--access_key_id-secret_key&quot;&gt;네이버 클라우드 API 인증키 : access_key_id, secret_key&lt;/h4&gt;
&lt;p&gt;두가지 Key는 네이버 클라우드 API 인증키로 [네이버 클라우드 포탈] -&amp;gt; [마이페이지] -&amp;gt; [계정관리] -&amp;gt; [인증키 관리] - [API 인증키 관리] 메뉴에서 Access Key ID와 Secret Key를 가져오셔야 하며, 아직 만들어진 Key가 없다면 새로 만드셔야 합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_api_auth_key_create.png&quot; alt=&quot;네이버 클라우드 API 인증키 생성하기&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;archive-storage-api-정보--domain_id-project_id&quot;&gt;Archive Storage API 정보:  domain_id, project_id&lt;/h4&gt;
&lt;p&gt;두가지 id 값은 Archive Storage API 이용을 위한 Domain ID와 Project ID로 [네이버 클라우드 포탈] - [Archive Storage]에서 [API 이용 정보 확인] 버튼을 클릭하면 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_api_access_token_create_01.png&quot; alt=&quot;네이버 클라우드 PHP로 Archive Storage API 인증 토큰 생성하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;[API 이용 정보 확인] 창에서 Domain ID와 Project ID를 확인하고, 인증토큰 생성 코드에 입력합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_api_access_token_create_02.png&quot; alt=&quot;네이버 클라우드 PHP로 Archive Storage API 인증 토큰 생성하는 방법&quot; style=&quot;width:500px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;위에서 확인한 설정 값 4가지를 추가해서 인증토큰 생성 명령을 실행하면 아래와 같이 생성된 인증토큰이 출력됩니다.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;OS_STORAGE_URL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;https://kr.archive.ncloudstorage.com/v1/AUTH_&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;project_id&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;OS_AUTH_TOKEN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;={&lt;/span&gt;인증 토큰&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_cli_windows_guide_06.png&quot; alt=&quot;네이버 클라우드 Archive Storage CLI를 Windows 환경에서 사용하는 방법에 대한 가이드&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;인증-토큰-유효-시간&quot;&gt;인증 토큰 유효 시간&lt;/h2&gt;
&lt;p&gt;API 인증 토큰의 유효 시간은 24시간이고 삭제 요청을 호출하면 삭제할 수 있습니다.&lt;/p&gt;

&lt;h2 id=&quot;환경-변수-설정&quot;&gt;환경 변수 설정&lt;/h2&gt;
&lt;p&gt;위에서 생성된 인증토큰과 URL을 환경 변수에 설정합니다. Windows에서는 export 명령을 set로 변경해서 실행합니다.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;OS_STORAGE_URL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;https://kr.archive.ncloudstorage.com/v1/AUTH_&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;project_id&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;OS_AUTH_TOKEN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;={&lt;/span&gt;인증 토큰&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_cli_windows_guide_07.png&quot; alt=&quot;네이버 클라우드 Archive Storage CLI를 Windows 환경에서 사용하는 방법에 대한 가이드&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;컨테이너버킷-조회&quot;&gt;컨테이너(버킷) 조회&lt;/h2&gt;
&lt;p&gt;현재 Archive Storage에 생성되어 있는 컨테이너(버킷)을 확인할 수 있는 명령어는 다음과 같습니다.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;swift list
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_cli_windows_guide_08.png&quot; alt=&quot;네이버 클라우드 Archive Storage CLI를 Windows 환경에서 사용하는 방법에 대한 가이드&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;컨테이너버킷의-모든-오브젝트-조회&quot;&gt;컨테이너(버킷)의 모든 오브젝트 조회&lt;/h4&gt;
&lt;p&gt;특정 컨테이너(버킷)의 모든 오브젝트 목록을 확인하는 명령어는 마지막에 컨테이너(버킷) 이름을 적어주면 됩니다.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;swift list &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;컨테이너&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;버킷&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 이름&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_cli_windows_guide_09.png&quot; alt=&quot;네이버 클라우드 Archive Storage CLI를 Windows 환경에서 사용하는 방법에 대한 가이드&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;파일-업로드&quot;&gt;파일 업로드&lt;/h2&gt;
&lt;p&gt;파일 업로드 명령은 특정 파일을 업로드 하는 명령과 폴더를 통째로 업로드 하는 명령을 각각 확인해보겠습니다.&lt;/p&gt;

&lt;h4 id=&quot;폴더-업로드&quot;&gt;폴더 업로드&lt;/h4&gt;
&lt;p&gt;폴더를 통째로 업로드 하는 명령은 다음과 같습니다.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;swift upload &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;컨테이너&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;버킷&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 이름&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--object-name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;저장할 Archive Storage 폴더명&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;로컬PC 폴더명&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;폴더 파일을 업로드 후에 list 명령어로 컨테이너(버킷)의 오브젝트 목록을 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_cli_windows_guide_10.png&quot; alt=&quot;네이버 클라우드 Archive Storage CLI를 Windows 환경에서 사용하는 방법에 대한 가이드&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;개별-파일-업로드&quot;&gt;개별 파일 업로드&lt;/h4&gt;
&lt;p&gt;특정 파일을 업로드 하려면 다음처럼 명령을 실행하면 됩니다.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;swift upload &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;컨테이너&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;버킷&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 이름&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--object-name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;저장할 Archive Storage 폴더명/저장할 파일명&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;로컬PC 파일 경로&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;마찬가지로 파일을 업로드 후에 list 명령어로 확인해보시면 됩니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_cli_windows_guide_11.png&quot; alt=&quot;네이버 클라우드 Archive Storage CLI를 Windows 환경에서 사용하는 방법에 대한 가이드&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;파일-삭제&quot;&gt;파일 삭제&lt;/h2&gt;
&lt;p&gt;파일 삭제도 개별 파일 삭제와 폴더 삭제 2가지로 나누어서 확인해보겠습니다.&lt;/p&gt;

&lt;h4 id=&quot;개별-파일-삭제&quot;&gt;개별 파일 삭제&lt;/h4&gt;
&lt;p&gt;특정 파일을 삭제하는 명령은 다음과 같습니다.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;swift delete &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;컨테이너&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;버킷&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 이름&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Archive Storage 파일 전체 경로&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_cli_windows_guide_12.png&quot; alt=&quot;네이버 클라우드 Archive Storage CLI를 Windows 환경에서 사용하는 방법에 대한 가이드&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;폴더-삭제&quot;&gt;폴더 삭제&lt;/h4&gt;
&lt;p&gt;폴더 전체를 삭제하는 명령은 prefix 옵션이 들어갑니다.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;swift delete &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;컨테이너&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;버킷&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 이름&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--prefix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Archive Storage 폴더 경로&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_cli_windows_guide_13.png&quot; alt=&quot;네이버 클라우드 Archive Storage CLI를 Windows 환경에서 사용하는 방법에 대한 가이드&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;파일-다운로드&quot;&gt;파일 다운로드&lt;/h2&gt;
&lt;p&gt;파일 다운로드는 개별 파일 다운로드와 폴더 다운로드 그리고, 컨테이너(버킷) 파일 전체 다운로드를 실행해 보고, 로컬PC에서 다운로드 된 것을 확인해보겠습니다.&lt;/p&gt;

&lt;h4 id=&quot;개별-파일-다운로드&quot;&gt;개별 파일 다운로드&lt;/h4&gt;
&lt;p&gt;개별 파일 다운로드에는 output 옵션이 필요합니다.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;swift download &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;컨테이너&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;버킷&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 이름&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;저장할 로컬PC 파일 전체 경로&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Archive Storage 파일 전체 경로&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_cli_windows_guide_14.png&quot; alt=&quot;네이버 클라우드 Archive Storage CLI를 Windows 환경에서 사용하는 방법에 대한 가이드&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;로컬PC에서 확인을 해보면 아래와 같이 다운로드된 파일을 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_cli_windows_guide_15.png&quot; alt=&quot;네이버 클라우드 Archive Storage CLI를 Windows 환경에서 사용하는 방법에 대한 가이드&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;폴더-다운로드&quot;&gt;폴더 다운로드&lt;/h4&gt;
&lt;p&gt;폴더 다운로드에는 output-dir 옵션이 필요합니다.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;swift download &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;컨테이너&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;버킷&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 이름&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--output-dir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;저장할 로컬PC 폴더 경로&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Archive Storage 폴더 경로&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_cli_windows_guide_16.png&quot; alt=&quot;네이버 클라우드 Archive Storage CLI를 Windows 환경에서 사용하는 방법에 대한 가이드&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;로컬PC에서 확인을 해보면 아래와 같이 폴더가 다운로드 된 것을 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_cli_windows_guide_17.png&quot; alt=&quot;네이버 클라우드 Archive Storage CLI를 Windows 환경에서 사용하는 방법에 대한 가이드&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;컨테이너버킷-전체-다운로드&quot;&gt;컨테이너(버킷) 전체 다운로드&lt;/h4&gt;
&lt;p&gt;컨테이너(버킷)에 있는 모든 파일을 다운로드 할 때는 아래와 같이 폴더 다운로드 명령에서 마지막에 있는 파일명이나 폴더명 파라미터를 지우시면 됩니다.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;swift download &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;컨테이너&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;버킷&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 이름&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--output-dir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;저장할 로컬PC 폴더 경로&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_cli_windows_guide_18.png&quot; alt=&quot;네이버 클라우드 Archive Storage CLI를 Windows 환경에서 사용하는 방법에 대한 가이드&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;로컬PC에서 확인을 해보면 폴더와 파일이 모두 다운로드 된 것을 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_cli_windows_guide_19.png&quot; alt=&quot;네이버 클라우드 Archive Storage CLI를 Windows 환경에서 사용하는 방법에 대한 가이드&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;주의-사항&quot;&gt;주의 사항&lt;/h2&gt;

&lt;h4 id=&quot;archive-storage-cli를-사용해야-하는-이유&quot;&gt;Archive Storage CLI를 사용해야 하는 이유&lt;/h4&gt;
&lt;p&gt;마지막으로 Archive Storage를 관리할 때는 AWS S3용 Client Tool (ex, CloudBerry Explorer, S3 Browser) 대신에 Archive Storage CLI를 사용해야 하는 이유에 대해 정리해보겠습니다.&lt;/p&gt;

&lt;p&gt;네이버 클라우드(Ncloud) Archive Storage는 Object Storage의 데이터를 장기 백업하기 위한 용도 등으로 주로 사용되다 보니 Object Storage와 비슷한 시스템이라고 오해하는 경우가 많습니다. 
하지만, Object Storage가 AWS S3와 호환되는 시스템 구조로 되어 있는 것에 반해, Archive Storage는 OpenStack 기반의 시스템 구조로 되어 있어 전혀 다르다고 보시면 됩니다.&lt;/p&gt;

&lt;p&gt;그러다 보니, Object Storage를 관리하는데 자주 사용되는 AWS S3용 Client Tool (ex, CloudBerry Explorer, S3 Browser) 등을 Archive Storage를 관리할 때도 사용하는 경우가 있는데, 가급적 사용하지 않는 것이 좋습니다. 
왜냐하면 &lt;strong&gt;AWS S3용 Client Tool로 Archive Storage에서 업로드, 다운로드, 삭제, 이름변경 등의 작업을 진행하면 해당 파일에 문제가 생기거나 때로는 컨테이너(버킷) 데이터 전체에 문제가 생길 수도 있기 때문&lt;/strong&gt;입니다.&lt;/p&gt;

&lt;p&gt;혹시나 AWS S3용 Client Tool을 사용하더라도 파일(오브젝트)을 조회하는 용도 정도로만 한정해서 사용하는 것을 추천합니다. 물론 파일 조회도 가능하면 Archive Storage용의 CLI나 API를 이용하는 것이 좋습니다.&lt;/p&gt;

&lt;h2 id=&quot;참고-url&quot;&gt;참고 URL&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;Archive Storage CLI 가이드
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://cli.ncloud-docs.com/docs/guide-archivestorage&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://cli.ncloud-docs.com/docs/guide-archivestorage&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;OpenStack CLI 가이드
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://docs.openstack.org/ocata/cli-reference/swift.html&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://docs.openstack.org/ocata/cli-reference/swift.html&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;blockquote&gt;
  &lt;p&gt;문서 최종 수정일 : 2021-11-19&lt;/p&gt;
&lt;/blockquote&gt;</content><author><name>{&quot;name&quot;=&gt;nil, &quot;email&quot;=&gt;nil, &quot;twitter&quot;=&gt;nil}</name></author><summary type="html">개요 네이버 클라우드(Ncloud) Archive Storage CLI를 Windows 환경에서 사용하는 방법에 대해 정리해보겠습니다.</summary></entry><entry><title type="html">PHP로 Archive Storage API 호출하기 - 컨테이너(버킷) 오브젝트 목록 조회</title><link href="https://docs.3rdeyesys.com/4.storage/ncp_storage_archive_storage_api_get_container_by_php/" rel="alternate" type="text/html" title="PHP로 Archive Storage API 호출하기 - 컨테이너(버킷) 오브젝트 목록 조회" /><published>2021-11-16T00:00:00+09:00</published><updated>2021-11-16T00:00:00+09:00</updated><id>https://docs.3rdeyesys.com/4.storage/ncp_storage_archive_storage_api_get_container_by_php</id><content type="html" xml:base="https://docs.3rdeyesys.com/4.storage/ncp_storage_archive_storage_api_get_container_by_php/">&lt;h2 id=&quot;개요&quot;&gt;개요&lt;/h2&gt;
&lt;p&gt;네이버 클라우드(Ncloud) Archive Storage API를 이용해서 컨테이너(버킷)에 있는 오브젝트 전체 목록을 PHP로 조회하는 방법에 대해 정리해보겠습니다.&lt;/p&gt;

&lt;h2 id=&quot;api-정보&quot;&gt;API 정보&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;OpenStack Swift API : 2.15.1 (Pike)&lt;/li&gt;
  &lt;li&gt;OpenStack Keystone V3 API : v3.8&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;인증-토큰-생성&quot;&gt;인증 토큰 생성&lt;/h2&gt;
&lt;p&gt;Archive Storage API를 호출할 때는 먼저 인증 토큰을 생성해야 하는데, 생성 방법은 내용이 다소 긴 관계로 다른 문서에서 자세히 설명해두었습니다. 
아래 문서를 참고 하시기 바랍니다.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/4.storage/ncp_storage_archive_storage_api_access_token_create/&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;PHP로 Archive Storage API 인증 토큰 생성하는 방법 (docs.3rdeyesys.com)&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;오브젝트-목록-조회-코드&quot;&gt;오브젝트 목록 조회 코드&lt;/h2&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;

  &lt;span class=&quot;nv&quot;&gt;$x_auth_token&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Archive Storage API 인증 토큰&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;nv&quot;&gt;$ncloud_project_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Archive Storage 프로젝트 ID&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$ncloud_container&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Archive Storage 컨테이너(버킷) 이름&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  
  &lt;span class=&quot;nv&quot;&gt;$api_server&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;https://kr.archive.ncloudstorage.com&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$api_url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/v1/AUTH_&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ncloud_project_id&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ncloud_container&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;?format=json&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;		

  &lt;span class=&quot;c1&quot;&gt;// http 호출 헤더값 설정&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$http_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$http_header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;X-Auth-Token: &quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$x_auth_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$http_header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;charset=UTF-8&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;// api 호출&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;curl_init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_URL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$api_server&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$api_url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_SSL_VERIFYPEER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_RETURNTRANSFER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;	
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_HTTPHEADER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$http_header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_HEADER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//request에 header 값도 수신&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//GET 방식으로 호출&lt;/span&gt;

  &lt;span class=&quot;nv&quot;&gt;$response&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;curl_exec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$http_code&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;curl_getinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLINFO_HTTP_CODE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  		
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$http_code&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;c1&quot;&gt;// response에서 header 값 분리&lt;/span&gt;
		&lt;span class=&quot;nv&quot;&gt;$headers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
		&lt;span class=&quot;nv&quot;&gt;$header_text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;substr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;strpos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;

		&lt;span class=&quot;k&quot;&gt;foreach&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;explode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$header_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
		&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			   &lt;span class=&quot;nv&quot;&gt;$headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http_code&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			   &lt;span class=&quot;k&quot;&gt;list&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;explode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;: &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
			   &lt;span class=&quot;nv&quot;&gt;$headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

		&lt;span class=&quot;c1&quot;&gt;// response에서 json형태의 body 값 분리&lt;/span&gt;
		&lt;span class=&quot;nv&quot;&gt;$json_response&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;substr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;strpos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
		&lt;span class=&quot;nv&quot;&gt;$rows_response&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;json_decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$json_response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;JSON_OBJECT_AS_ARRAY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

		&lt;span class=&quot;nv&quot;&gt;$object_count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;X-Container-Object-Count&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
		&lt;span class=&quot;nv&quot;&gt;$used_bytes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;X-Container-Bytes-Used&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
		&lt;span class=&quot;nv&quot;&gt;$used_k_bytes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$used_bytes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;nv&quot;&gt;$used_m_bytes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$used_k_bytes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;nv&quot;&gt;$used_g_bytes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$used_m_bytes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$http_code&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;404&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;존재하지 않는 컨테이너(버킷)입니다&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

		&lt;span class=&quot;nv&quot;&gt;$rows_response&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;	

		&lt;span class=&quot;nv&quot;&gt;$object_count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;nv&quot;&gt;$used_bytes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;nv&quot;&gt;$used_k_bytes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;nv&quot;&gt;$used_m_bytes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;nv&quot;&gt;$used_g_bytes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  	&lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Error&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;


&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// 오브젝트 목록 출력&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$cnt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;foreach&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$rows_response&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;				
  	&lt;span class=&quot;nv&quot;&gt;$archive_object_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
  	&lt;span class=&quot;nv&quot;&gt;$archive_object_hash&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;hash&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
  	&lt;span class=&quot;nv&quot;&gt;$archive_object_content_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;content_type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
  	&lt;span class=&quot;nv&quot;&gt;$archive_object_last_modified&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;last_modified&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
  	&lt;span class=&quot;nv&quot;&gt;$archive_object_bytes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;bytes&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

  	&lt;span class=&quot;nv&quot;&gt;$cnt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;tr&amp;gt;&lt;/span&gt; 	  						
	  &lt;span class=&quot;nt&quot;&gt;&amp;lt;td&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cnt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/td&amp;gt;&lt;/span&gt;
	  &lt;span class=&quot;nt&quot;&gt;&amp;lt;td&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$archive_object_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/td&amp;gt;&lt;/span&gt;
	  &lt;span class=&quot;nt&quot;&gt;&amp;lt;td&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$archive_object_content_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/td&amp;gt;&lt;/span&gt;
	  &lt;span class=&quot;nt&quot;&gt;&amp;lt;td&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$archive_object_hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/td&amp;gt;&lt;/span&gt;					  
	  &lt;span class=&quot;nt&quot;&gt;&amp;lt;td&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$archive_object_last_modified&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/td&amp;gt;&lt;/span&gt;
	  &lt;span class=&quot;nt&quot;&gt;&amp;lt;td&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;number_format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$archive_object_bytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/td&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;/tr&amp;gt;&lt;/span&gt;

&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;	
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;코드-상세-설명&quot;&gt;코드 상세 설명&lt;/h2&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;archive-storage-api-이용-정보&quot;&gt;Archive Storage API 이용 정보&lt;/h4&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;nv&quot;&gt;$ncloud_project_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Archive Storage 프로젝트 ID&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$ncloud_container&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Archive Storage 컨테이너(버킷) 이름&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Archive Storage API 이용을 위한 Project ID는 [네이버 클라우드 포탈] - [Archive Storage]에서 [API 이용 정보 확인] 버튼을 클릭하면 확인할 수 있습니다.&lt;br /&gt;
테스트에 사용할 컨테이너(버킷)은 [test]로 설정해두었습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_api_get_container_by_php_04.png&quot; alt=&quot;네이버 클라우드에서 PHP로 Archive Storage API 호출하기 - 컨테이너(버킷) 오브젝트 목록 조회하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;[API 이용 정보 확인] 창에서 Project ID를 확인하고, PHP 소스코드에 입력합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_api_access_token_create_02.png&quot; alt=&quot;네이버 클라우드 PHP로 Archive Storage API 인증 토큰 생성하는 방법&quot; style=&quot;width:500px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;api-서버와-url-설정&quot;&gt;API 서버와 URL 설정&lt;/h4&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;nv&quot;&gt;$api_server&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;https://kr.archive.ncloudstorage.com&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$api_url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/v1/AUTH_&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ncloud_project_id&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ncloud_container&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;?format=json&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Archive Storage API 서버와 컨테이너(버킷)에 있는 오브젝트 목록을 조회하기 위한 URL 정보는 위와 같습니다. 
[프로젝트 ID]와 [컨테이너(버킷) 이름]을 URL에 포함시키고, 파라미터로는 전달받을 목록의 형태를 설정하게 되는데, 여기서는 json형태로 받겠습니다.&lt;/p&gt;

&lt;h4 id=&quot;header-값-설정&quot;&gt;Header 값 설정&lt;/h4&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;c1&quot;&gt;// http 호출 헤더값 설정&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$http_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$http_header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;X-Auth-Token: &quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$x_auth_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$http_header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;charset=UTF-8&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Archive Storage API 인증 토큰은 [X-Auth-Token] 라는 이름으로 header에 담아서 전송합니다.&lt;/p&gt;

&lt;h4 id=&quot;api-호출&quot;&gt;API 호출&lt;/h4&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;c1&quot;&gt;// api 호출&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;curl_init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_URL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$api_server&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$api_url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_SSL_VERIFYPEER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_RETURNTRANSFER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;	
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_HTTPHEADER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$http_header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_HEADER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//response에 header 값도 수신&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//GET 방식으로 호출&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;이제 위에서 준비한 값들을 사용해서 API를 호출합니다.&lt;br /&gt;
curl_setopt($ch, CURLOPT_HEADER, TRUE); 는 Response에 body 뿐만 아니라 header 값도 수신하기 위해 설정합니다.&lt;/p&gt;

&lt;h4 id=&quot;api-호출-응답-수신&quot;&gt;API 호출 응답 수신&lt;/h4&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;nv&quot;&gt;$response&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;curl_exec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$http_code&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;curl_getinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLINFO_HTTP_CODE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;API를 호출하고 응답을 수신합니다. 성공, 실패 등에 대한 HTTP 상태코드도 확인합니다.&lt;/p&gt;

&lt;h4 id=&quot;header-body-값-분리&quot;&gt;Header, Body 값 분리&lt;/h4&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;c1&quot;&gt;// response에서 header 값 분리&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$headers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$header_text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;substr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;strpos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;foreach&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;explode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$header_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	   &lt;span class=&quot;nv&quot;&gt;$headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http_code&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	   &lt;span class=&quot;k&quot;&gt;list&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;explode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;: &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	   &lt;span class=&quot;nv&quot;&gt;$headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;// response에서 json형태의 body 값 분리&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$json_response&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;substr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;strpos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$rows_response&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;json_decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$json_response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;JSON_OBJECT_AS_ARRAY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Resoponse에서 Header, Body 값을 따로 분리해서 배열에 저장합니다.&lt;/p&gt;

&lt;h4 id=&quot;컨테이너버킷-기본-정보-확인&quot;&gt;컨테이너(버킷) 기본 정보 확인&lt;/h4&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;nv&quot;&gt;$object_count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;X-Container-Object-Count&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$used_bytes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;X-Container-Bytes-Used&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$used_k_bytes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$used_bytes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$used_m_bytes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$used_k_bytes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$used_g_bytes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$used_m_bytes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;분리한 Header 값에서 컨테이너(버킷)의 기본 정보를 확인합니다.&lt;br /&gt;
[전체 오브젝트 개수], [사용 중인 용량]을 확인하고 용량은 Bytes 단위이기에 KB, MB, GB 단위로도 변환합니다.&lt;/p&gt;

&lt;h4 id=&quot;http-상태코드&quot;&gt;HTTP 상태코드&lt;/h4&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$http_code&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;//성공&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$http_code&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;404&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;존재하지 않는 컨테이너(버킷)입니다&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;요청이 성공하게 되면 OK (200), 컨테이너(버킷)이 존재하지 않는 경우는 Not Found (404) 상태 코드를 응답합니다.&lt;/p&gt;

&lt;h4 id=&quot;오브젝트-목록-html-출력&quot;&gt;오브젝트 목록 html 출력&lt;/h4&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// 오브젝트 목록 출력&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$cnt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;foreach&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$rows_response&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;				
  	&lt;span class=&quot;nv&quot;&gt;$archive_object_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
  	&lt;span class=&quot;nv&quot;&gt;$archive_object_hash&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;hash&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
  	&lt;span class=&quot;nv&quot;&gt;$archive_object_content_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;content_type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
  	&lt;span class=&quot;nv&quot;&gt;$archive_object_last_modified&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;last_modified&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
  	&lt;span class=&quot;nv&quot;&gt;$archive_object_bytes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;bytes&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

  	&lt;span class=&quot;nv&quot;&gt;$cnt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;tr&amp;gt;&lt;/span&gt; 	  						
	  &lt;span class=&quot;nt&quot;&gt;&amp;lt;td&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cnt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/td&amp;gt;&lt;/span&gt;
	  &lt;span class=&quot;nt&quot;&gt;&amp;lt;td&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$archive_object_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/td&amp;gt;&lt;/span&gt;
	  &lt;span class=&quot;nt&quot;&gt;&amp;lt;td&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$archive_object_content_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/td&amp;gt;&lt;/span&gt;
	  &lt;span class=&quot;nt&quot;&gt;&amp;lt;td&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$archive_object_hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/td&amp;gt;&lt;/span&gt;					  
	  &lt;span class=&quot;nt&quot;&gt;&amp;lt;td&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$archive_object_last_modified&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/td&amp;gt;&lt;/span&gt;
	  &lt;span class=&quot;nt&quot;&gt;&amp;lt;td&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;number_format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$archive_object_bytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/td&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;/tr&amp;gt;&lt;/span&gt;

&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;	
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;오브젝트 목록을 html로 출력합니다.&lt;br /&gt;
출력하는 정보는 [이름], [해시값], [Content Type], [최종 수정일], [용량(Bytes)] 입니다.&lt;/p&gt;

&lt;h2 id=&quot;목록-출력-예시&quot;&gt;목록 출력 예시&lt;/h2&gt;
&lt;p&gt;위의 코드를 실행하면 다음과 같이 오브젝트 목록이 출력됩니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_api_get_container_by_php_02.png&quot; alt=&quot;네이버 클라우드에서 PHP로 Archive Storage API 호출하기 - 컨테이너(버킷) 오브젝트 목록 조회하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;출력된 오브젝트 정보가 올바른지 확인하기 위해 네이버 클라우드(Ncloud) 콘솔에서 해당 컨테이너(버킷)의 정보를 확인하면 다음과 같이 일치하는 것을 알 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_api_get_container_by_php_01.png&quot; alt=&quot;네이버 클라우드에서 PHP로 Archive Storage API 호출하기 - 컨테이너(버킷) 오브젝트 목록 조회하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;제한-사항&quot;&gt;제한 사항&lt;/h2&gt;
&lt;p&gt;Archive Storage API를 이용해서 가져올 수 있는 오브젝트 목록의 최대 개수는 10,000개입니다. 
1만개 이상이 등록된 컨테이너(버킷)에서 오브젝트 목록을 요청해도 아래와 같이 최대 10,000개 까지만 가져올 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_api_get_container_by_php_03.png&quot; alt=&quot;네이버 클라우드에서 PHP로 Archive Storage API 호출하기 - 컨테이너(버킷) 오브젝트 목록 조회하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;컨테이너(버킷)에 10,000개 이상의 오브젝트가 저장되어 있을 경우에는 아래쪽에서 소개하는 방법처럼 폴더별로 오브젝트 목록을 따로 조회하시면 됩니다.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;오브젝트-검색&quot;&gt;오브젝트 검색&lt;/h2&gt;
&lt;p&gt;위에서는 컨테이너(버킷)에 저장된 모든 오브젝트들을 조회하는 기능을 확인해보았습니다.&lt;br /&gt;
다음으로는 특정 이름으로 시작되는 오브젝트나 특정 폴더에 있는 오브젝트만 조회하는 방법에 대해 위에서 확인한 PHP 예제 소스코드에서 변경이 필요한 부분만 확인해보겠습니다.&lt;/p&gt;

&lt;p&gt;테스트에 사용된 오브젝트와 폴더 구조는 다음과 같습니다.&lt;/p&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Test_Folder_0001&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Test_Folder&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;L&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Sub_Folder&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;L&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Sub_Sub_Folder&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h4 id=&quot;특정-이름으로-시작하는-오브젝트-목록&quot;&gt;특정 이름으로 시작하는 오브젝트 목록&lt;/h4&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;nv&quot;&gt;$ncloud_object_prefix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Test_Folder&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;nv&quot;&gt;$api_url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/v1/AUTH_&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ncloud_project_id&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ncloud_container&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;?format=json&amp;amp;prefix=&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ncloud_object_prefix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;		
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;API URL을 호출할 때 파라미터로 prefix를 전송하면 prefix 값에 해당하는 특정 문자열로 시작하는 오브젝트 목록을 모두 가져 옵니다.&lt;br /&gt;
예를 들어 prefix 값을 [Test_Folder]로 설정하면, 아래와 같이 [Test_Folder]라는 이름으로 시작되는 모든 오브젝트 목록을 가져오게 됩니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_api_get_container_by_php_05.png&quot; alt=&quot;네이버 클라우드에서 PHP로 Archive Storage API 호출하기 - 컨테이너(버킷) 오브젝트 목록 조회하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;특정-폴더-아래에-있는-오브젝트-목록&quot;&gt;특정 폴더 아래에 있는 오브젝트 목록&lt;/h4&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;nv&quot;&gt;$ncloud_object_prefix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Test_Folder/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;nv&quot;&gt;$api_url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/v1/AUTH_&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ncloud_project_id&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ncloud_container&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;?format=json&amp;amp;prefix=&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ncloud_object_prefix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;		
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;특정 폴더 아래에 있는 오브젝트 목록을 가져 올 때는 prefix 값 마지막에 슬래시 [ / ]를 추가하면 됩니다.
예를 들어 prefix 값을 [Test_Folder/]로 설정하면, 아래와 같이 [Test_Folder]라는 이름의 폴더 아래에 있는 모든 오브젝트 목록을 가져오게 됩니다.&lt;/p&gt;

&lt;p&gt;위쪽에서 확인한 [특정 이름으로 시작하는 오브젝트 목록]의 결과 예시와는 다르게 폴더 자체인 [Test_Folder] 그리고 [Test_Folder_0001.png]는 포함되어 있지 않습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_api_get_container_by_php_06.png&quot; alt=&quot;네이버 클라우드에서 PHP로 Archive Storage API 호출하기 - 컨테이너(버킷) 오브젝트 목록 조회하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;api-기타-기능&quot;&gt;API 기타 기능&lt;/h2&gt;
&lt;p&gt;Archive Storage API에서 지원하는 기능은 컨테이너(버킷)의 오브젝트 목록 외에도 아래와 같이 여러가지가 있습니다. 
위에서 사용한 것은 컨테이너(버킷) 오퍼레이션의 GET 기능입니다.&lt;/p&gt;

&lt;h4 id=&quot;어카운트-오퍼레이션&quot;&gt;어카운트 오퍼레이션&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;GET : 어카운트에 속한 컨테이너(버킷) 목록을 조회합니다.&lt;/li&gt;
  &lt;li&gt;HEAD : 어카운트의 메타데이터를 조회합니다.&lt;/li&gt;
  &lt;li&gt;POST : 어카운트에 메타데이터를 설정 및 변경합니다.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;컨테이너버킷-오퍼레이션&quot;&gt;컨테이너(버킷) 오퍼레이션&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;PUT : 컨테이너(버킷)을 생성합니다.&lt;/li&gt;
  &lt;li&gt;GET : 컨테이너(버킷)에 속한 오브젝트 목록을 조회합니다.&lt;/li&gt;
  &lt;li&gt;HEAD : 컨테이너(버킷)의 메타데이터를 조회합니다.&lt;/li&gt;
  &lt;li&gt;POST : 컨테이너(버킷)에 메타데이터를 설정 및 변경합니다.
 DELETE : 빈 컨테이너(버킷)을 삭제합니다.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;오브젝트-오퍼레이션&quot;&gt;오브젝트 오퍼레이션&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;PUT : 오브젝트를 업로드합니다. 동일한 이름의 오브젝트가 있을 경우 덮어쓰기를 합니다.&lt;/li&gt;
  &lt;li&gt;COPY : 다른 위치에 있는 오브젝트를 복제합니다.&lt;/li&gt;
  &lt;li&gt;GET : 오브젝트를 다운로드합니다.&lt;/li&gt;
  &lt;li&gt;HEAD : 오브젝트의 메타데이터를 조회합니다.&lt;/li&gt;
  &lt;li&gt;POST : 오브젝트에 메타데이터를 설정 및 변경합니다.&lt;/li&gt;
  &lt;li&gt;DELETE : 오브젝트를 삭제합니다.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;참고-url&quot;&gt;참고 URL&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;Archive Storage API 기본 가이드
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://api.ncloud-docs.com/docs/common-archivestorageapi-archivestorageapi&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://api.ncloud-docs.com/docs/common-archivestorageapi-archivestorageapi&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Archive Storage API 상세 가이드
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://api.ncloud-docs.com/docs/storage-archivestorage&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://api.ncloud-docs.com/docs/storage-archivestorage&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;OpenStack Keystone V3 API 가이드
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://docs.openstack.org/api-ref/identity/v3/&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://docs.openstack.org/api-ref/identity/v3/&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;blockquote&gt;
  &lt;p&gt;문서 최종 수정일 : 2021-11-17&lt;/p&gt;
&lt;/blockquote&gt;</content><author><name>{&quot;name&quot;=&gt;nil, &quot;email&quot;=&gt;nil, &quot;twitter&quot;=&gt;nil}</name></author><summary type="html">개요 네이버 클라우드(Ncloud) Archive Storage API를 이용해서 컨테이너(버킷)에 있는 오브젝트 전체 목록을 PHP로 조회하는 방법에 대해 정리해보겠습니다.</summary></entry><entry><title type="html">PHP로 Archive Storage API 인증 토큰 생성하는 방법</title><link href="https://docs.3rdeyesys.com/4.storage/ncp_storage_archive_storage_api_access_token_create/" rel="alternate" type="text/html" title="PHP로 Archive Storage API 인증 토큰 생성하는 방법" /><published>2021-11-11T00:00:00+09:00</published><updated>2021-11-11T00:00:00+09:00</updated><id>https://docs.3rdeyesys.com/4.storage/ncp_storage_archive_storage_api_access_token_create</id><content type="html" xml:base="https://docs.3rdeyesys.com/4.storage/ncp_storage_archive_storage_api_access_token_create/">&lt;h2 id=&quot;개요&quot;&gt;개요&lt;/h2&gt;
&lt;p&gt;네이버 클라우드(Ncloud) Archive Storage API를 이용하려고 할 때 먼저 인증 토큰을 생성하고 생성된 토큰을 이용해서 API로 Archive Storage에 접근해야 합니다. 
여기서는 PHP로 API 인증 토큰을 생성하는 방법에 대해 우선 전체 소스코드를 살펴보고 다음으로 주요 코드를 상세하게 살펴보겠습니다.&lt;/p&gt;

&lt;h2 id=&quot;api-정보&quot;&gt;API 정보&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;OpenStack Swift API : 2.15.1 (Pike)&lt;/li&gt;
  &lt;li&gt;OpenStack Keystone V3 API : v3.8&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;인증-토큰-생성-코드&quot;&gt;인증 토큰 생성 코드&lt;/h2&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;// 전송해야 할 설정값&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$ncloud_accesskey&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;네이버 클라우드 AccessKey&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$ncloud_secretkey&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;네이버 클라우드 SecretKey&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$ncloud_domain_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Archive Storage 도메인 ID&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$ncloud_project_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Archive Storage 프로젝트 ID&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;nv&quot;&gt;$api_server&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;https://kr.archive.ncloudstorage.com:5000&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$api_url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/v3/auth/tokens&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;		 

  &lt;span class=&quot;c1&quot;&gt;// http 호출 헤더값 설정&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$http_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$http_header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Content-Type: application/json&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;// 전송할 값들을 배열 형태로 저장한다&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$postvars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
  	&lt;span class=&quot;s2&quot;&gt;&quot;auth&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
  		&lt;span class=&quot;s2&quot;&gt;&quot;identity&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
  			&lt;span class=&quot;s2&quot;&gt;&quot;methods&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
  				&lt;span class=&quot;s2&quot;&gt;&quot;password&quot;&lt;/span&gt;
  			&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
  			&lt;span class=&quot;s2&quot;&gt;&quot;password&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
  				&lt;span class=&quot;s2&quot;&gt;&quot;user&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
  					&lt;span class=&quot;s2&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ncloud_accesskey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  					&lt;span class=&quot;s2&quot;&gt;&quot;password&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ncloud_secretkey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  					&lt;span class=&quot;s2&quot;&gt;&quot;domain&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
  						&lt;span class=&quot;s2&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ncloud_domain_id&lt;/span&gt;
  					&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  				&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  			&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  		&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
  		&lt;span class=&quot;s2&quot;&gt;&quot;scope&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
  			&lt;span class=&quot;s2&quot;&gt;&quot;project&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
  				&lt;span class=&quot;s2&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ncloud_project_id&lt;/span&gt;
  			&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  		&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  	&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;// 배열 형태로 저장한 값들을 json 형태로 변환해서 전송&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$json_portvars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;json_encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$postvars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;// api 호출&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;curl_init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_URL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$api_server&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$api_url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_SSL_VERIFYPEER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_RETURNTRANSFER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;	
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//POST 방식으로 호출&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_HTTPHEADER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$http_header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_HEADER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//response에 header 값도 수신&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;CURLOPT_POSTFIELDS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$json_portvars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

  &lt;span class=&quot;nv&quot;&gt;$response&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;curl_exec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

  &lt;span class=&quot;nb&quot;&gt;curl_close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  	&lt;span class=&quot;c1&quot;&gt;// X-Subject-Token 토큰 값은 request body가 아닌 header로 전달되므로&lt;/span&gt;
  	&lt;span class=&quot;c1&quot;&gt;// header를 분리해서 배열에 저장한다 &lt;/span&gt;
  	&lt;span class=&quot;nv&quot;&gt;$headers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  	&lt;span class=&quot;nv&quot;&gt;$header_text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;substr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;strpos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;

  	&lt;span class=&quot;k&quot;&gt;foreach&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;explode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$header_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
  	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  		&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  		&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  		   &lt;span class=&quot;nv&quot;&gt;$headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http_code&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  		&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
  		&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  		   &lt;span class=&quot;k&quot;&gt;list&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;explode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;: &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  		   &lt;span class=&quot;nv&quot;&gt;$headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	
	&lt;span class=&quot;c1&quot;&gt;// 인증 토큰 확인&lt;/span&gt;
  	&lt;span class=&quot;nv&quot;&gt;$x_auth_token&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;X-Subject-Token&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; 
  	&lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$x_auth_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

  	&lt;span class=&quot;c1&quot;&gt;//var_dump($headers);&lt;/span&gt;
  	&lt;span class=&quot;c1&quot;&gt;//echo(&quot;&amp;lt;hr&amp;gt;&quot;);&lt;/span&gt;
  	&lt;span class=&quot;c1&quot;&gt;//var_dump($response);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; 
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; 
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  	&lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Curl error: &quot;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;curl_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;코드-상세-설명&quot;&gt;코드 상세 설명&lt;/h2&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h4 id=&quot;네이버-클라우드-인증키&quot;&gt;네이버 클라우드 인증키&lt;/h4&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;nv&quot;&gt;$ncloud_accesskey&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;네이버 클라우드 AccessKey&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$ncloud_secretkey&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;네이버 클라우드 SecretKey&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;네이버 클라우드 인증키는 [네이버 클라우드 포탈] -&amp;gt; [마이페이지] -&amp;gt; [계정관리] -&amp;gt; [인증키 관리] - [API 인증키 관리] 메뉴에서 Access Key ID와 Secret Key를 가져오셔야 하며, 아직 만들어진 Key가 없다면 새로 만드셔야 합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_api_auth_key_create.png&quot; alt=&quot;네이버 클라우드 API 인증키 생성하기&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;archive-storage-api-이용-정보&quot;&gt;Archive Storage API 이용 정보&lt;/h4&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;nv&quot;&gt;$ncloud_domain_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Archive Storage 도메인 ID&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$ncloud_project_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Archive Storage 프로젝트 ID&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Archive Storage API 이용을 위한 Domain ID와 Project ID는 [네이버 클라우드 포탈] - [Archive Storage]에서 [API 이용 정보 확인] 버튼을 클릭하면 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_api_access_token_create_01.png&quot; alt=&quot;네이버 클라우드 PHP로 Archive Storage API 인증 토큰 생성하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;[API 이용 정보 확인] 창에서 Domain ID와 Project ID를 확인하고, PHP 소스코드에 입력합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/ncloud_storage_archive_storage_api_access_token_create_02.png&quot; alt=&quot;네이버 클라우드 PHP로 Archive Storage API 인증 토큰 생성하는 방법&quot; style=&quot;width:500px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;api-서버와-url-설정&quot;&gt;API 서버와 URL 설정&lt;/h4&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;nv&quot;&gt;$api_server&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;https://kr.archive.ncloudstorage.com:5000&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$api_url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/v3/auth/tokens&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Archive Storage API 서버와 토큰 생성을 위한 URL 정보는 위와 같습니다.&lt;/p&gt;

&lt;h4 id=&quot;http-호출-header-값-설정&quot;&gt;HTTP 호출 header 값 설정&lt;/h4&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;nv&quot;&gt;$http_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$http_header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Content-Type: application/json&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;HTTP header에는 json 형태로 호출한다는 것을 설정합니다.&lt;/p&gt;

&lt;h4 id=&quot;전송할-값-설정&quot;&gt;전송할 값 설정&lt;/h4&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;c1&quot;&gt;// 전송할 값들을 배열 형태로 저장&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$postvars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
  	&lt;span class=&quot;s2&quot;&gt;&quot;auth&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
  		&lt;span class=&quot;s2&quot;&gt;&quot;identity&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
  			&lt;span class=&quot;s2&quot;&gt;&quot;methods&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
  				&lt;span class=&quot;s2&quot;&gt;&quot;password&quot;&lt;/span&gt;
  			&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
  			&lt;span class=&quot;s2&quot;&gt;&quot;password&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
  				&lt;span class=&quot;s2&quot;&gt;&quot;user&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
  					&lt;span class=&quot;s2&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ncloud_accesskey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  					&lt;span class=&quot;s2&quot;&gt;&quot;password&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ncloud_secretkey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  					&lt;span class=&quot;s2&quot;&gt;&quot;domain&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
  						&lt;span class=&quot;s2&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ncloud_domain_id&lt;/span&gt;
  					&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  				&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  			&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  		&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
  		&lt;span class=&quot;s2&quot;&gt;&quot;scope&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
  			&lt;span class=&quot;s2&quot;&gt;&quot;project&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
  				&lt;span class=&quot;s2&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ncloud_project_id&lt;/span&gt;
  			&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  		&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  	&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;// 배열 형태로 저장한 값들을 json 형태로 변환해서 전송&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$json_portvars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;json_encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$postvars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;네이버 클라우드 AccessKey, SecretKey, Archive Storage 도메인 ID, 프로젝트 ID를 전송하기 위해 지정된 형태의 배열로 저장한 후에 json 형태로 변환합니다. 
물론 처음부터 json 형태로 저장해도 됩니다.&lt;/p&gt;

&lt;h4 id=&quot;api-호출&quot;&gt;API 호출&lt;/h4&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;curl_init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_URL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$api_server&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$api_url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_SSL_VERIFYPEER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_RETURNTRANSFER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;	
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//POST 방식으로 호출&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_HTTPHEADER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$http_header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_HEADER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//response에 header 값도 수신&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;CURLOPT_POSTFIELDS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$json_portvars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

  &lt;span class=&quot;nv&quot;&gt;$response&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;curl_exec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;curl_close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;이제 위에서 준비한 값들을 사용해서 API를 호출합니다.&lt;br /&gt;
curl_setopt($ch, CURLOPT_HEADER, TRUE); 는 Response에 body 뿐만 아니라 header 값도 수신하기 위해 설정합니다.&lt;/p&gt;

&lt;h4 id=&quot;api-인증-토큰-분리&quot;&gt;API 인증 토큰 분리&lt;/h4&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  	&lt;span class=&quot;nv&quot;&gt;$headers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  	&lt;span class=&quot;nv&quot;&gt;$header_text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;substr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;strpos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;

  	&lt;span class=&quot;k&quot;&gt;foreach&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;explode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$header_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
  	&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  		&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  		&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  		   &lt;span class=&quot;nv&quot;&gt;$headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http_code&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  		&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
  		&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  		   &lt;span class=&quot;k&quot;&gt;list&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;explode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;: &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  		   &lt;span class=&quot;nv&quot;&gt;$headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	
	&lt;span class=&quot;c1&quot;&gt;// 인증 토큰 확인&lt;/span&gt;
  	&lt;span class=&quot;nv&quot;&gt;$x_auth_token&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;X-Subject-Token&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; 
  	&lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$x_auth_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

  	&lt;span class=&quot;c1&quot;&gt;//var_dump($headers);&lt;/span&gt;
  	&lt;span class=&quot;c1&quot;&gt;//echo(&quot;&amp;lt;hr&amp;gt;&quot;);&lt;/span&gt;
  	&lt;span class=&quot;c1&quot;&gt;//var_dump($response);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;API 인증 토큰값은 X-Subject-Token이라는 이름으로 request body가 아닌 header로 전달되므로 header를 분리해서 배열에 저장합니다.
실제 전송되는 header 값은 아래와 같은 형태입니다.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;HTTP/1.1 201 Created 
Date: Thu, 11 Nov 2021 07:59:32 GMT 
Server: Apache/2.4.6 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CentOS&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; OpenSSL/1.0.2k-fips mod_wsgi/3.4 Python/2.7.5 
X-Subject-Token: gAAAAABhjM1lbeTW3Vq......중간 생략 ......txWYsWGrC1siPt8CE0rs_KgNMTQ 
Vary: X-Auth-Token 
x-openstack-request-id: req-1ce......중간 생략 ......a85eb5b 
Content-Length: 1762 
Content-Type: application/json
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;인증-토큰-유효-시간&quot;&gt;인증 토큰 유효 시간&lt;/h2&gt;
&lt;p&gt;API 인증 토큰의 유효 시간은 24시간이고 삭제 요청을 호출하면 삭제할 수 있습니다.&lt;/p&gt;

&lt;h2 id=&quot;참고-url&quot;&gt;참고 URL&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;Archive Storage API 기본 가이드
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://api.ncloud-docs.com/docs/common-archivestorageapi-archivestorageapi&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://api.ncloud-docs.com/docs/common-archivestorageapi-archivestorageapi&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;OpenStack Keystone V3 API 가이드
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://docs.openstack.org/api-ref/identity/v3/&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://docs.openstack.org/api-ref/identity/v3/&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;blockquote&gt;
  &lt;p&gt;문서 최종 수정일 : 2021-11-11&lt;/p&gt;
&lt;/blockquote&gt;</content><author><name>{&quot;name&quot;=&gt;nil, &quot;email&quot;=&gt;nil, &quot;twitter&quot;=&gt;nil}</name></author><summary type="html">개요 네이버 클라우드(Ncloud) Archive Storage API를 이용하려고 할 때 먼저 인증 토큰을 생성하고 생성된 토큰을 이용해서 API로 Archive Storage에 접근해야 합니다. 여기서는 PHP로 API 인증 토큰을 생성하는 방법에 대해 우선 전체 소스코드를 살펴보고 다음으로 주요 코드를 상세하게 살펴보겠습니다.</summary></entry><entry><title type="html">PHP로 텔레그램 비공개 채널에 메시지 전송하기</title><link href="https://docs.3rdeyesys.com/99.etc/ncp_etc_php_to_telegram_message_send/" rel="alternate" type="text/html" title="PHP로 텔레그램 비공개 채널에 메시지 전송하기" /><published>2021-11-10T00:00:00+09:00</published><updated>2021-11-10T00:00:00+09:00</updated><id>https://docs.3rdeyesys.com/99.etc/ncp_etc_php_to_telegram_message_send</id><content type="html" xml:base="https://docs.3rdeyesys.com/99.etc/ncp_etc_php_to_telegram_message_send/">&lt;h2 id=&quot;개요&quot;&gt;개요&lt;/h2&gt;
&lt;p&gt;업무를 진행하다보면 서버나 서비스에 장애가 발생했을 때 즉시 알림을 받거나 서버 상태 모니터링이나 매출 등의 서비스 이용 지표 등을 매일 자동으로 통보 받는 경우가 있습니다. 
예전에는 이메일이나 SMS 메시지로 받는 경우가 대부분이었는데, 요즘은 관련된 사람들이 함께 들어와 있는 메신저 채팅방으로 알림을 동시에 받는 경우도 많아지고 있습니다.&lt;br /&gt;
그럴 때 사용하는 방법 중에서 여기서는 텔레그램(Telegram)의 대화방인 비공개 채널에 메시지를 전송하는 것을 PHP로 구현해보겠습니다.&lt;/p&gt;

&lt;h2 id=&quot;구현-순서&quot;&gt;구현 순서&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;텔레그램 채팅 봇을 생성&lt;/li&gt;
  &lt;li&gt;텔레그램 채널을 비공개로 생성&lt;/li&gt;
  &lt;li&gt;비공개 채널에 위에서 생성한 채팅 봇을 관리자로 등록&lt;/li&gt;
  &lt;li&gt;PHP로 채팅 봇을 이용해 비공개 채널에 메시지를 전송&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;채팅-봇-생성&quot;&gt;채팅 봇 생성&lt;/h2&gt;
&lt;p&gt;텔레그램(Telegram) 메신저에서 채팅 봇을 생성하고 관리해주는 봇인 [&lt;strong&gt;BotFather&lt;/strong&gt;]를 검색합니다. 
여러 개의 봇들이 나타나는데 그 중에서 인증 마크가 붙어 있는 텔레그램 공식 봇을 선하고 채팅 방에  들어갑니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/etc_php_to_telegram_msg_send_01.png&quot; alt=&quot;PHP로 텔레그램(Telegram) 비공개 채널에 메시지 전송하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;[BotFather] 채팅 봇 방에 들어가면 채팅 봇에 대한 설명과 봇 API 매뉴얼 링크를 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/etc_php_to_telegram_msg_send_02.png&quot; alt=&quot;PHP로 텔레그램(Telegram) 비공개 채널에 메시지 전송하는 방법&quot; style=&quot;width:642px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;이제 채팅 봇 생성을 위해 &lt;strong&gt;/start&lt;/strong&gt; 명령을 입력하면 아래와 같이 채팅 봇 생성, 관리에 대한 명령어들을 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/etc_php_to_telegram_msg_send_03.png&quot; alt=&quot;PHP로 텔레그램(Telegram) 비공개 채널에 메시지 전송하는 방법&quot; style=&quot;width:637px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;다음으로 새로운 채팅 봇을 생성하는 명령어인 &lt;strong&gt;/newbot&lt;/strong&gt;을 입력하면, 채팅 봇 이름과 채팅 봇 유저명을 입력하라는 안내가 나옵니다. 
차례대로 입력하면 되는데, 여기서 입력하는 이름을 텔레그램 내에서 고유한 값이므로 간단한 이름을 입력하면 중복된 이름이라 생성이 되지 않으니 자신만의 고유한 이름을 입력합니다.&lt;/p&gt;

&lt;p&gt;그리고 두번째로 입력하는 &lt;strong&gt;채팅 봇 유저명(username for your bot)은 반드시 마지막이 bot&lt;/strong&gt;로 끝나야 합니다. 
두가지 모두 입력하고 나면 아래쪽에 채팅 봇과 연동하기 위한 API Token을 확인할 수 있는데, 이 Token을 PHP에서 사용하게 됩니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/etc_php_to_telegram_msg_send_04.png&quot; alt=&quot;PHP로 텔레그램(Telegram) 비공개 채널에 메시지 전송하는 방법&quot; style=&quot;width:637px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;채팅 봇이 생성되었는지 텔레그램에서 검색해보면 아래와 같이 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/etc_php_to_telegram_msg_send_05.png&quot; alt=&quot;PHP로 텔레그램(Telegram) 비공개 채널에 메시지 전송하는 방법&quot; style=&quot;width:632px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;채널-생성&quot;&gt;채널 생성&lt;/h2&gt;
&lt;p&gt;채널을 생성하기 위해 텔레그램 왼쪽 메뉴를 클릭합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/etc_php_to_telegram_msg_send_06.png&quot; alt=&quot;PHP로 텔레그램(Telegram) 비공개 채널에 메시지 전송하는 방법&quot; style=&quot;width:632px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;메뉴 화면에서 [채널 만들기]를 클릭합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/etc_php_to_telegram_msg_send_07.png&quot; alt=&quot;PHP로 텔레그램(Telegram) 비공개 채널에 메시지 전송하는 방법&quot; style=&quot;width:632px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;원하는 채널명을 입력하고, 만들기를 클릭하면, 공개-비공개를 선택할 수 있는데 여기서는 [비공개 채널]을 선택하고 저장합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/etc_php_to_telegram_msg_send_08.png&quot; alt=&quot;PHP로 텔레그램(Telegram) 비공개 채널에 메시지 전송하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;저장하고 나면 다음으로 [참가자 추가] 화면이 나타나는데 위에서 생성했던 채팅 봇 이름을 입력해서 확인하고, 선택 후에 [추가] 버튼을 클릭합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/etc_php_to_telegram_msg_send_10.png&quot; alt=&quot;PHP로 텔레그램(Telegram) 비공개 채널에 메시지 전송하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;그러면 아래와 같이 [봇은 관리자로서만 추가될 수 있습니다]라는 메시지가 나타납니다. 바로 [관리자로 세우기] 버튼을 클릭합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/etc_php_to_telegram_msg_send_12.png&quot; alt=&quot;PHP로 텔레그램(Telegram) 비공개 채널에 메시지 전송하는 방법&quot; style=&quot;width:632px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;관리자의 권한은 여러가지가 있는데 원하는 권한을 부여하고 [저장] 버튼을 클릭합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/etc_php_to_telegram_msg_send_13.png&quot; alt=&quot;PHP로 텔레그램(Telegram) 비공개 채널에 메시지 전송하는 방법&quot; style=&quot;width:632px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;채팅-방-id-확인&quot;&gt;채팅 방 ID 확인&lt;/h2&gt;
&lt;p&gt;메시지를 전송하기 위해서는 현재 생성된 비공개 채널의 chat_id를 확인해야 합니다.&lt;br /&gt;
우선, 채널에서 아무 메시지나 입력합니다. (&lt;strong&gt;꼭 하셔야 합니다&lt;/strong&gt;)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/etc_php_to_telegram_msg_send_14.png&quot; alt=&quot;PHP로 텔레그램(Telegram) 비공개 채널에 메시지 전송하는 방법&quot; style=&quot;width:632px;align:center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;다음으로 웹브라우저에서 다음 주소를 입력합니다.  주소에는 위에서 확인했던 API Token이 들어갑니다.&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;https://api.telegram.org/bot[API Token]/getUpdates

# 예시
https://api.telegram.org/bot123456789:JFDS89FMJK8932-MKJE8FNBH3289I/getUpdates
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;br /&gt;
입력하면 나타나면 결과에서 “chat” : {“id” : -12586498, ….} 와 같은 형식의 &lt;strong&gt;id&lt;/strong&gt; 값을 복사합니다. 이 값이 바로 비공개 채널의 chat_id 입니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/etc_php_to_telegram_msg_send_15.png&quot; alt=&quot;PHP로 텔레그램(Telegram) 비공개 채널에 메시지 전송하는 방법&quot; style=&quot;width:770px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;메시지-전송-코드-작성&quot;&gt;메시지 전송 코드 작성&lt;/h2&gt;
&lt;p&gt;마지막으로 메시지를 전송하는 PHP 코드를 작성해보겠습니다.&lt;br /&gt;
위에서 구했던 [API Token], [chat_id]를 아래 코드에 입력하고 실행하면 됩니다.&lt;/p&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;php_to_telegram_msg_send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$api_token&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;API Token&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$chat_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;채팅방 ID&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$api_url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;https://api.telegram.org/bot&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$api_token&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/sendMessage&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;$post_vars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;chat_id=&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$chat_id&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&amp;amp;text=&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;urlencode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$content_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Content-Type: application/x-www-form-urlencoded&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;curl_init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

    &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_URL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$api_url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_HEADER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_RETURNTRANSFER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_SSL_VERIFYPEER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_TIMEOUT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_HTTPHEADER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$content_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CURLOPT_POSTFIELDS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$post_vars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;$return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;curl_exec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;nb&quot;&gt;curl_close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;


  &lt;span class=&quot;nv&quot;&gt;$tgm_msg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;		
  &lt;span class=&quot;nv&quot;&gt;$tgm_msg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$tgm_msg&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;메시지 테스트&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;nv&quot;&gt;$output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;php_to_telegram_msg_send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$tgm_msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;	
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;br /&gt;
위 코드를 실행하면 아래와 같이 비공개 채널에 메시지가 도착한 것을 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/etc_php_to_telegram_msg_send_16.png&quot; alt=&quot;PHP로 텔레그램(Telegram) 비공개 채널에 메시지 전송하는 방법&quot; style=&quot;width:632px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;메시지-스타일-적용&quot;&gt;메시지 스타일 적용&lt;/h2&gt;
&lt;p&gt;텔레그램 채팅 봇 API는 메시지에 bold, underline 등의 몇가지 html 스타일을 지원합니다.&lt;br /&gt;
html 스타일을 적용하기 위해서는 전송 파라미터에 &lt;strong&gt;parse_mode=html&lt;/strong&gt;을 추가해야 합니다.&lt;br /&gt;
그러면 위 전송 코드 중에서 변경해야 하는 코드만 정리해보겠습니다.&lt;/p&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;

  &lt;span class=&quot;cm&quot;&gt;/* 전송 파라미터에 parse_mode=html을 추가합니다. */&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$post_vars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;chat_id=&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$chat_id&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&amp;amp;text=&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;urlencode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&amp;amp;parse_mode=html&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;		

  &lt;span class=&quot;nv&quot;&gt;$tgm_msg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$tgm_msg&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;b&amp;gt;bold&amp;lt;/b&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$tgm_msg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$tgm_msg&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;i&amp;gt;italic&amp;lt;/i&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$tgm_msg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$tgm_msg&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;code&amp;gt;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\$&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;now_date = date('Y-m-d');&amp;lt;/code&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$tgm_msg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$tgm_msg&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;s&amp;gt;strike&amp;lt;/s&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$tgm_msg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$tgm_msg&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;u&amp;gt;underline&amp;lt;/u&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$tgm_msg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$tgm_msg&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;pre language='php'&amp;gt;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\$&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;now_date = date('Y-m-d');&amp;lt;/pre&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$tgm_msg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$tgm_msg&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;email@test.com&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$tgm_msg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$tgm_msg&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;pre&amp;gt;email@test.com&amp;lt;/pre&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;br /&gt;
위 코드처럼 스타일을 적용하고 실행하면 아래와 같이 표시됩니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../images/etc_php_to_telegram_msg_send_17.png&quot; alt=&quot;PHP로 텔레그램(Telegram) 비공개 채널에 메시지 전송하는 방법&quot; style=&quot;width:632px;align:center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;참고-url&quot;&gt;참고 URL&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;텔레그램 채팅 봇 안내
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://core.telegram.org/bots/&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://core.telegram.org/bots/&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;텔레그램 채팅 봇 API 가이드
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://core.telegram.org/bots/api/&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://core.telegram.org/bots/api/&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;텔레그램 채팅 봇 API 메시지 스타일 가이드
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://core.telegram.org/api/entities/&quot; target=&quot;_blank&quot; style=&quot;word-break:break-all;&quot;&gt;https://core.telegram.org/api/entities/&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;blockquote&gt;
  &lt;p&gt;문서 최종 수정일 : 2021-11-10&lt;/p&gt;
&lt;/blockquote&gt;</content><author><name>{&quot;name&quot;=&gt;nil, &quot;email&quot;=&gt;nil, &quot;twitter&quot;=&gt;nil}</name></author><summary type="html">개요 업무를 진행하다보면 서버나 서비스에 장애가 발생했을 때 즉시 알림을 받거나 서버 상태 모니터링이나 매출 등의 서비스 이용 지표 등을 매일 자동으로 통보 받는 경우가 있습니다. 예전에는 이메일이나 SMS 메시지로 받는 경우가 대부분이었는데, 요즘은 관련된 사람들이 함께 들어와 있는 메신저 채팅방으로 알림을 동시에 받는 경우도 많아지고 있습니다. 그럴 때 사용하는 방법 중에서 여기서는 텔레그램(Telegram)의 대화방인 비공개 채널에 메시지를 전송하는 것을 PHP로 구현해보겠습니다.</summary></entry></feed>